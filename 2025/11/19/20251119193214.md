# Commit: a55990bd3a78df607da14de96406b8932cd4b5ce
## Message: GP-6136 fix ByteViewer exception when clicking on partial line

ByteViewer formats that use several bytes (eg. hex long, hex long long)
cause a class cast exception when a row with partial data is displayed.
## Diff:
```
diff --git a/Ghidra/Features/ByteViewer/src/main/java/ghidra/app/plugin/core/byteviewer/ByteViewerComponent.java b/Ghidra/Features/ByteViewer/src/main/java/ghidra/app/plugin/core/byteviewer/ByteViewerComponent.java
index 8c84254b925..58136f0c148 100644
--- a/Ghidra/Features/ByteViewer/src/main/java/ghidra/app/plugin/core/byteviewer/ByteViewerComponent.java
+++ b/Ghidra/Features/ByteViewer/src/main/java/ghidra/app/plugin/core/byteviewer/ByteViewerComponent.java
@@ -566,18 +566,13 @@ private int adjustCharacterOffsetForBytesField(FieldLocation fieldLoc, int chara
 			return characterOffset;
 		}
 
-		int column = fieldLoc.getCol() + characterOffset;
 		int fieldNum = fieldLoc.getFieldNum();
-		int fieldRow = fieldLoc.getRow();
-		ByteField field = (ByteField) layout.getField(fieldNum);
-		if (field != null) {
-			// not sure this can be null
-			int numCols = field.getNumCols(fieldRow);
-			if (column >= numCols) {
-				column = numCols - 1;
-			}
+		if (!(layout.getField(fieldNum) instanceof ByteField field)) {
+			return characterOffset;
 		}
 
+		int column = Math.clamp(fieldLoc.getCol() + characterOffset, 0,
+			field.getNumCols(fieldLoc.getRow()) - 1);
 		return column;
 	}
 
```
-----------------------------------
