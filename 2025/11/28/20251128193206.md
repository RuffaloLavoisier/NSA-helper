# Commit: 1d86eaf7452a822abd83116084187e1b2dbe5be8
## Message: GP-0 fix more external address leakage in DWARF import
## Diff:
```
diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/MemoryByteProvider.java b/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/MemoryByteProvider.java
index 1f38a3109ac..d361c5c422e 100644
--- a/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/MemoryByteProvider.java
+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/MemoryByteProvider.java
@@ -159,6 +159,10 @@ public MemoryByteProvider(Memory memory, Address baseAddress, Address maxAddress
 		this.isEmtpy = maxAddress == null;
 	}
 
+	public Memory getMemory() {
+		return memory;
+	}
+
 	private Address getAddress(long index) throws IOException {
 		if (index == 0) {
 			return baseAddress;
diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/format/dwarf/DWARFProgram.java b/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/format/dwarf/DWARFProgram.java
index dc980409b40..cf118b007c6 100644
--- a/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/format/dwarf/DWARFProgram.java
+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/format/dwarf/DWARFProgram.java
@@ -573,7 +573,10 @@ private boolean hasRelocations(BinaryReader br) {
 		}
 		ByteProvider bp = br.getByteProvider();
 		if (bp instanceof MemoryByteProvider mbp && !mbp.isEmpty()) {
-			if (program.getRelocationTable().getRelocations(mbp.getAddressSet()).hasNext()) {
+			Program providerProgram = mbp.getMemory().getProgram();
+			if (providerProgram.getRelocationTable()
+					.getRelocations(mbp.getAddressSet())
+					.hasNext()) {
 				return true;
 			}
 		}
```
-----------------------------------
