# Commit: 52b4d46cb34034e151737b87cf9713e06f11d757
## Message: GP-0: Detecting VSCode in Windows system installer location
(Closes #8514)
## Diff:
```
diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/vscode/VSCodeIntegrationOptionsPlugin.java b/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/vscode/VSCodeIntegrationOptionsPlugin.java
index 749be4ba4dd..e32e0675a04 100644
--- a/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/vscode/VSCodeIntegrationOptionsPlugin.java
+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/vscode/VSCodeIntegrationOptionsPlugin.java
@@ -66,12 +66,18 @@ public void init() {
 	 */
 	private static File getDefaultVSCodeExecutable() {
 		return switch (OperatingSystem.CURRENT_OPERATING_SYSTEM) {
-			case WINDOWS -> new File(System.getenv("LOCALAPPDATA"),
-				"Programs/Microsoft VS Code/bin/code.cmd");
-			case MAC_OS_X -> new File(
-				"/Applications/Visual Studio Code.app/Contents/MacOS/Electron");
-			case LINUX -> new File("/usr/bin/code");
-			default -> null;
+			case WINDOWS:
+				File local = new File(System.getenv("LOCALAPPDATA"),
+					"Programs/Microsoft VS Code/bin/code.cmd");
+				File admin =
+					new File(System.getenv("PROGRAMFILES"), "Microsoft VS Code/bin/code.cmd");
+				yield admin.exists() ? admin : local;
+			case MAC_OS_X:
+				yield new File("/Applications/Visual Studio Code.app/Contents/MacOS/Electron");
+			case LINUX:
+				yield new File("/usr/bin/code");
+			default:
+				yield null;
 		};
 	}
 }
```
-----------------------------------
