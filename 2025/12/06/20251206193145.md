# Commit: a2975887efac45443e857a10dd82afd63a0e5317
## Message: Merge remote-tracking branch 'origin/GP-6177-dragonmacher-xref-table-fixes--SQUASHED' into Ghidra_12.0
## Diff:
```
diff --git a/Ghidra/Features/Base/src/main/help/help/topics/CodeBrowserPlugin/CodeBrowser.htm b/Ghidra/Features/Base/src/main/help/help/topics/CodeBrowserPlugin/CodeBrowser.htm
index 35306b3db36..3300b4e33ad 100644
--- a/Ghidra/Features/Base/src/main/help/help/topics/CodeBrowserPlugin/CodeBrowser.htm
+++ b/Ghidra/Features/Base/src/main/help/help/topics/CodeBrowserPlugin/CodeBrowser.htm
@@ -170,6 +170,13 @@ <H3><A NAME="Delete_Reference"></A>Delete Reference
 				from the <A HREF="help/topics/Search/Query_Results_Dialog.htm#Remove_Items">Remove Items					
 				</A> action, which will simply remove items from the table.
     			</P>
+				
+				<BLOCKQUOTE>
+				<P><IMG border="0" src="help/shared/tip.png" alt="">If the <CODE>RefType</CODE> is
+				<CODE>THUNK</CODE>, then that reference cannot be deleted.  However, it may be 
+				<I>removed</I> from the table.</P>
+				</BLOCKQUOTE>
+				
     		</BLOCKQUOTE>
       
     </BLOCKQUOTE>
diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/util/XReferenceUtils.java b/Ghidra/Features/Base/src/main/java/ghidra/app/util/XReferenceUtils.java
index cc3af7245a0..347bf54af23 100644
--- a/Ghidra/Features/Base/src/main/java/ghidra/app/util/XReferenceUtils.java
+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/util/XReferenceUtils.java
@@ -355,7 +355,21 @@ public boolean isEnabledForContext(ActionContext c) {
 			if (tableModel.isBusy()) {
 				return false;
 			}
-			return table.getSelectedRowCount() > 0;
+			return hasNonThunkRefs(table);
+		}
+
+		private boolean hasNonThunkRefs(JTable table) {
+			int[] rows = table.getSelectedRows();
+			for (int row : rows) {
+				ReferenceEndpoint rowObject = tableModel.getRowObject(row);
+				Reference ref = rowObject.getReference();
+				RefType type = ref.getReferenceType();
+				if (type != RefType.THUNK) {
+					return true;
+				}
+
+			}
+			return false;
 		}
 
 		@Override
@@ -391,8 +405,13 @@ private static void deleteXrefs(PluginTool tool, Program program,
 		CompoundCmd<Program> compoundCmd = new CompoundCmd<>("Delete References");
 		for (int row : rows) {
 			ReferenceEndpoint endpoint = tableModel.getRowObject(row);
-			deletedRowObjects.add(endpoint);
 			Reference ref = endpoint.getReference();
+			RefType type = ref.getReferenceType();
+			if (type == RefType.THUNK) {
+				continue; // we cannot delete THUNK types, as they are not real references
+			}
+
+			deletedRowObjects.add(endpoint);
 			RemoveReferenceCmd cmd = new RemoveReferenceCmd(ref);
 			compoundCmd.add(cmd);
 		}
```
-----------------------------------
