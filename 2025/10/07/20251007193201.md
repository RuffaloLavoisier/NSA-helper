# Commit: 2819cf371e4ad4599a0c93b85b7b31163c30f98b
## Message: Merge remote-tracking branch 'origin/GP-6024-dragonmacher-vt-missing-options' into Ghidra_12.0
## Diff:
```
diff --git a/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/PluginManager.java b/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/PluginManager.java
index d8811e190e0..de35486898e 100644
--- a/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/PluginManager.java
+++ b/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/PluginManager.java
@@ -425,7 +425,6 @@ Element saveDataStateToXml(boolean savingProject) {
 	private void unregisterPlugin(Plugin plugin) {
 		if (pluginList.remove(plugin)) {
 			plugin.cleanup();
-			tool.getOptionsManager().deregisterOwner(plugin);
 		}
 	}
 
diff --git a/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/mgr/OptionsManager.java b/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/mgr/OptionsManager.java
index dd10bfb3a9b..b9e57857826 100644
--- a/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/mgr/OptionsManager.java
+++ b/Ghidra/Framework/Project/src/main/java/ghidra/framework/plugintool/mgr/OptionsManager.java
@@ -4,9 +4,9 @@
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
- * 
+ *
  *      http://www.apache.org/licenses/LICENSE-2.0
- * 
+ *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
@@ -28,7 +28,6 @@
 import docking.tool.ToolConstants;
 import docking.tool.util.DockingToolConstants;
 import ghidra.framework.options.*;
-import ghidra.framework.plugintool.Plugin;
 import ghidra.framework.plugintool.PluginTool;
 import ghidra.framework.plugintool.dialog.KeyBindingsPanel;
 import ghidra.util.HelpLocation;
@@ -111,9 +110,7 @@ public void showOptionsDialog(String category, String filterText) {
 	public ToolOptions[] getOptions() {
 		ToolOptions[] opt = new ToolOptions[optionsMap.size()];
 		int idx = 0;
-		Iterator<String> iter = optionsMap.keySet().iterator();
-		while (iter.hasNext()) {
-			String key = iter.next();
+		for (String key : optionsMap.keySet()) {
 			opt[idx] = optionsMap.get(key);
 			++idx;
 		}
@@ -121,24 +118,6 @@ public ToolOptions[] getOptions() {
 		return opt;
 	}
 
-	/**
-	 * Deregister the owner from the options; if options are empty, then
-	 * remove the options from the map.
-	 * @param ownerPlugin the owner plugin
-	 */
-	public void deregisterOwner(Plugin ownerPlugin) {
-		List<String> deleteList = new ArrayList<>();
-		Iterator<String> iter = optionsMap.keySet().iterator();
-		while (iter.hasNext()) {
-			String key = iter.next();
-			ToolOptions opt = optionsMap.get(key);
-			if (opt.getOptionNames().isEmpty()) {
-				deleteList.add(opt.getName());
-			}
-		}
-		removeUnusedOptions(deleteList);
-	}
-
 	/**
 	 * Write this object out; first remove any unused options so they
 	 * do not hang around.
@@ -146,9 +125,7 @@ public void deregisterOwner(Plugin ownerPlugin) {
 	 */
 	public Element getConfigState() {
 		Element root = new Element("OPTIONS");
-		Iterator<String> iter = optionsMap.keySet().iterator();
-		while (iter.hasNext()) {
-			String key = iter.next();
+		for (String key : optionsMap.keySet()) {
 			ToolOptions opt = optionsMap.get(key);
 			if (hasNonDefaultValues(opt)) {
 				root.addContent(opt.getXmlRoot(false));
@@ -170,9 +147,7 @@ private boolean hasNonDefaultValues(Options options) {
 	public void removeUnusedOptions() {
 		// 1st clean up any unused options before saving...
 		List<String> deleteList = new ArrayList<>();
-		Iterator<String> iter = optionsMap.keySet().iterator();
-		while (iter.hasNext()) {
-			String key = iter.next();
+		for (String key : optionsMap.keySet()) {
 			ToolOptions opt = optionsMap.get(key);
 			opt.removeUnusedOptions();
 			if (opt.getOptionNames().isEmpty()) {
@@ -239,9 +214,9 @@ private OptionsDialog createOptionsDialog() {
 		}
 
 		keyBindingOptions.registerOptionsEditor(() -> new KeyBindingOptionsEditor());
-		OptionsDialog dialog =
-			new OptionsDialog("Options for " + tool.getName(), "Options", getEditableOptions(),
-				null, true);
+		String optionsName = "Options for " + tool.getName();
+		Options[] options = getEditableOptions();
+		OptionsDialog dialog = new OptionsDialog(optionsName, "Options", options, null, true);
 		dialog.setSelectedPath(path);
 		dialog.setHelpLocation(
 			new HelpLocation(ToolConstants.TOOL_HELP_TOPIC, "ToolOptions_Dialog"));
```
-----------------------------------
