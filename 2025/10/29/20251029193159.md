# Commit: 2597c243b99d70a5c8baf2f485d19f922f6ad3b1
## Message: Merge remote-tracking branch 'origin/Ghidra_12.0'
## Diff:
```
diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/analysis/rust/RustUtilities.java b/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/analysis/rust/RustUtilities.java
index 8b6234c1d30..d28b38c40ed 100644
--- a/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/analysis/rust/RustUtilities.java
+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/analysis/rust/RustUtilities.java
@@ -28,6 +28,7 @@
 import ghidra.program.database.SpecExtension;
 import ghidra.program.model.address.Address;
 import ghidra.program.model.address.AddressSet;
+import ghidra.program.model.lang.Language;
 import ghidra.program.model.lang.Processor;
 import ghidra.program.model.listing.Program;
 import ghidra.program.model.mem.MemoryBlock;
@@ -68,11 +69,11 @@ public static boolean isRust(Program program, MemoryBlock block, TaskMonitor mon
 		// can later query and use as a return value for this method.
 		GenericMatchAction<AtomicBoolean> action =
 			new GenericMatchAction<AtomicBoolean>(new AtomicBoolean()) {
-			@Override
-			public void apply(Program prog, Address addr, Match match) {
-				getMatchValue().set(true);
-			}
-		};
+				@Override
+				public void apply(Program prog, Address addr, Match match) {
+					getMatchValue().set(true);
+				}
+			};
 		MemoryBytePatternSearcher searcher = new MemoryBytePatternSearcher("Rust signatures");
 		for (byte[] sig : RustConstants.RUST_SIGNATURES) {
 			searcher.addPattern(new GenericByteSequencePattern<AtomicBoolean>(sig, action));
@@ -97,9 +98,11 @@ public static boolean isRustProgram(Program program) {
 
 	public static int addExtensions(Program program, TaskMonitor monitor, String subPath)
 			throws IOException {
-		Processor processor = program.getLanguageCompilerSpecPair().getLanguage().getProcessor();
-		ResourceFile module = Application.getModuleDataSubDirectory(processor.toString(),
-			RustConstants.RUST_EXTENSIONS_PATH + subPath);
+		Language language = program.getLanguageCompilerSpecPair().getLanguage();
+		Processor processor = language.getProcessor();
+		int bitSize = language.getLanguageDescription().getSize();
+		String spath = RustConstants.RUST_EXTENSIONS_PATH + subPath + bitSize;
+		ResourceFile module = Application.getModuleDataSubDirectory(processor.toString(), spath);
 
 		int extensionCount = 0;
 
diff --git a/Ghidra/Processors/x86/certification.manifest b/Ghidra/Processors/x86/certification.manifest
index 1b6dd3dfb3d..71dfe249477 100644
--- a/Ghidra/Processors/x86/certification.manifest
+++ b/Ghidra/Processors/x86/certification.manifest
@@ -1,11 +1,16 @@
 ##VERSION: 2.0
 Module.manifest||GHIDRA||||END|
 README.md||GHIDRA||||END|
-data/extensions/rust/unix/cc.xml||GHIDRA||||END|
-data/extensions/rust/unix/probe_fixup.xml||GHIDRA||||END|
-data/extensions/rust/unix/try_fixup.xml||GHIDRA||||END|
-data/extensions/rust/windows/probe_fixup.xml||GHIDRA||||END|
-data/extensions/rust/windows/try_fixup.xml||GHIDRA||||END|
+data/extensions/rust/unix32/cc.xml||GHIDRA||||END|
+data/extensions/rust/unix32/probe_fixup.xml||GHIDRA||||END|
+data/extensions/rust/unix32/try_fixup.xml||GHIDRA||||END|
+data/extensions/rust/unix64/cc.xml||GHIDRA||||END|
+data/extensions/rust/unix64/probe_fixup.xml||GHIDRA||||END|
+data/extensions/rust/unix64/try_fixup.xml||GHIDRA||||END|
+data/extensions/rust/windows32/probe_fixup.xml||GHIDRA||||END|
+data/extensions/rust/windows32/try_fixup.xml||GHIDRA||||END|
+data/extensions/rust/windows64/probe_fixup.xml||GHIDRA||||END|
+data/extensions/rust/windows64/try_fixup.xml||GHIDRA||||END|
 data/languages/adx.sinc||GHIDRA||||END|
 data/languages/avx.sinc||GHIDRA||||END|
 data/languages/avx2.sinc||GHIDRA||||END|
diff --git a/Ghidra/Processors/x86/data/extensions/rust/unix32/cc.xml b/Ghidra/Processors/x86/data/extensions/rust/unix32/cc.xml
new file mode 100644
index 00000000000..4a7b38b0bb9
--- /dev/null
+++ b/Ghidra/Processors/x86/data/extensions/rust/unix32/cc.xml
@@ -0,0 +1,34 @@
+<prototype name="__rustcall" extrapop="8" stackshift="8">
+  <input>
+    <pentry minsize="1" maxsize="500" align="4">
+      <addr offset="4" space="stack"/>
+    </pentry>
+  </input>
+  <output killedbycall="true">
+    <pentry minsize="4" maxsize="10" metatype="float" extension="float">
+      <register name="ST0"/>
+    </pentry>
+    <pentry minsize="1" maxsize="4">
+      <register name="EAX"/>
+    </pentry>
+    <pentry minsize="5" maxsize="8">
+      <addr space="join" piece1="EDX" piece2="EAX"/>
+    </pentry>
+  </output>
+  <unaffected>
+    <register name="ESP"/>
+    <register name="EBP"/>
+    <register name="ESI"/>
+    <register name="EDI"/>
+    <register name="EBX"/>
+  </unaffected>
+  <killedbycall>
+    <register name="ECX"/>
+    <register name="EDX"/>
+    <register name="ST0"/>
+    <register name="ST1"/>
+  </killedbycall>
+  <likelytrash>
+    <register name="EAX"/>
+  </likelytrash>
+</prototype>
diff --git a/Ghidra/Processors/x86/data/extensions/rust/unix/probe_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/unix32/probe_fixup.xml
similarity index 100%
rename from Ghidra/Processors/x86/data/extensions/rust/unix/probe_fixup.xml
rename to Ghidra/Processors/x86/data/extensions/rust/unix32/probe_fixup.xml
diff --git a/Ghidra/Processors/x86/data/extensions/rust/unix32/try_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/unix32/try_fixup.xml
new file mode 100644
index 00000000000..1d7cbcca598
--- /dev/null
+++ b/Ghidra/Processors/x86/data/extensions/rust/unix32/try_fixup.xml
@@ -0,0 +1,8 @@
+<callfixup name="__rust_try">
+    <target name="__rust_try"/>
+    <pcode>
+	<body><![CDATA[
+	    call [EDI];
+	    ]]></body>
+    </pcode>
+</callfixup>
diff --git a/Ghidra/Processors/x86/data/extensions/rust/unix/cc.xml b/Ghidra/Processors/x86/data/extensions/rust/unix64/cc.xml
similarity index 100%
rename from Ghidra/Processors/x86/data/extensions/rust/unix/cc.xml
rename to Ghidra/Processors/x86/data/extensions/rust/unix64/cc.xml
diff --git a/Ghidra/Processors/x86/data/extensions/rust/windows/probe_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/unix64/probe_fixup.xml
similarity index 100%
rename from Ghidra/Processors/x86/data/extensions/rust/windows/probe_fixup.xml
rename to Ghidra/Processors/x86/data/extensions/rust/unix64/probe_fixup.xml
diff --git a/Ghidra/Processors/x86/data/extensions/rust/unix/try_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/unix64/try_fixup.xml
similarity index 100%
rename from Ghidra/Processors/x86/data/extensions/rust/unix/try_fixup.xml
rename to Ghidra/Processors/x86/data/extensions/rust/unix64/try_fixup.xml
diff --git a/Ghidra/Processors/x86/data/extensions/rust/windows32/probe_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/windows32/probe_fixup.xml
new file mode 100644
index 00000000000..9bb5fd098a1
--- /dev/null
+++ b/Ghidra/Processors/x86/data/extensions/rust/windows32/probe_fixup.xml
@@ -0,0 +1,8 @@
+<callfixup name="__rust_probestack">
+    <target name="__rust_probestack"/>
+    <pcode>
+	<body><![CDATA[
+	    temp:1 = 0;
+	    ]]></body>
+    </pcode>
+</callfixup>
diff --git a/Ghidra/Processors/x86/data/extensions/rust/windows32/try_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/windows32/try_fixup.xml
new file mode 100644
index 00000000000..ecb17a9fb55
--- /dev/null
+++ b/Ghidra/Processors/x86/data/extensions/rust/windows32/try_fixup.xml
@@ -0,0 +1,8 @@
+<callfixup name="__rust_try">
+    <target name="__rust_try"/>
+    <pcode>
+	<body><![CDATA[
+	    call [EAX];
+	    ]]></body>
+    </pcode>
+</callfixup>
diff --git a/Ghidra/Processors/x86/data/extensions/rust/windows64/probe_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/windows64/probe_fixup.xml
new file mode 100644
index 00000000000..9bb5fd098a1
--- /dev/null
+++ b/Ghidra/Processors/x86/data/extensions/rust/windows64/probe_fixup.xml
@@ -0,0 +1,8 @@
+<callfixup name="__rust_probestack">
+    <target name="__rust_probestack"/>
+    <pcode>
+	<body><![CDATA[
+	    temp:1 = 0;
+	    ]]></body>
+    </pcode>
+</callfixup>
diff --git a/Ghidra/Processors/x86/data/extensions/rust/windows/try_fixup.xml b/Ghidra/Processors/x86/data/extensions/rust/windows64/try_fixup.xml
similarity index 100%
rename from Ghidra/Processors/x86/data/extensions/rust/windows/try_fixup.xml
rename to Ghidra/Processors/x86/data/extensions/rust/windows64/try_fixup.xml
```
-----------------------------------
