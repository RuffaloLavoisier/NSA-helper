# Commit: b85c2b5947ab406ff1aaacd68200a9b0e8eb03b0
## Message: GP-5884 - PDB CPP - Reconstruct parent source order
## Diff:
```
diff --git a/Ghidra/Features/PDB/src/main/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeType.java b/Ghidra/Features/PDB/src/main/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeType.java
index a8e67553c03..746bc355201 100644
--- a/Ghidra/Features/PDB/src/main/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeType.java
+++ b/Ghidra/Features/PDB/src/main/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeType.java
@@ -57,6 +57,8 @@ public class CppCompositeType {
 	private Composite composite;
 	private Composite selfBaseType;
 
+	private String sourceHierarchy;
+
 	private Map<String, String> vxtPtrSummary;
 	private String summarizedClassVxtPtrInfo;
 
@@ -127,6 +129,12 @@ private static record VirtualFunctionInfo(Integer tableOffset, Integer thisAdjus
 	 */
 	private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBases;
 
+	private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBasesFromDirectBases;
+	private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBasesFromDirectVirtualBases;
+	private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBasesFromIndirectVirtualBases;
+	private LinkedHashMap<ClassID, List<ClassID>> orderedVirtualBasesForDirectBase;
+	private LinkedHashMap<ClassID, List<ClassID>> orderedVirtualBasesForDirectVirtualBase;
+
 	private List<Member> layoutVftPtrMembers;
 	private List<Member> layoutVbtPtrMembers;
 
@@ -833,11 +841,180 @@ private void createHierarchicalClassLayout(MsVxtManager vxtManager,
 
 		createClassLayout(vxtManager, layoutOptions, monitor);
 
-		// See comment located with this method regardign possible future removal.
+		// See comment located with this method regarding possible future removal.
 		updateOrderedVxtsInVirtualBases(vxtManager);
 
 		finalizeAllVxtParentage();
+	}
+
+	// This method and the deptherFirstVirtualBases() method, together, do more than determine
+	// source order hierarchy.  There is still more to do here and in other similar methods
+	// to consolidate work that is done in meaningful ways.  Not making more changes at
+	// this time, as some study still needs to be done in trying to improve class speculative
+	// layout.  However, with this work and other work done for this commit, improvements
+	// were made in speculative layout of some classes. Also modified was depthFirstVirtualBases(),
+	// which is gathering more information that is used here regarding depth-first base classes
+	// of this class's direct base classes as well as depth-first base classes of this class's
+	// direct virtual base classes.  These separate collections are then both iterated in
+	// conjunction with the virtual base class order from the virtual base table to determine
+	// the next parent of this class.
+	/**
+	 * (See non-javadoc above.)<p>
+	 * Returns string representation of source hierachy; e.g., "struct C : virtual A, B"<p>
+	 * @return the string
+	 * @throws PdbException upon issue trying to get virtual base table information from the
+	 *  program (if there is a program)
+	 */
+	private String determineBaseSourceOrder() throws PdbException {
+
+		StringBuilder result = new StringBuilder();
+		result.append(classKey.getString() + " " + getClassId().getSymbolPath());
+
+		Iterator<DirectLayoutBaseClass> dIter = directLayoutBaseClasses.iterator();
+		DirectLayoutBaseClass dNext = dIter.hasNext() ? dIter.next() : null;
+		CppCompositeType dBase = dNext != null ? dNext.getBaseClassType() : null;
+		ClassID dId = dBase != null ? dBase.getClassId() : null;
+
+		Iterator<DirectVirtualLayoutBaseClass> vIter = directVirtualLayoutBaseClasses.iterator();
+		DirectVirtualLayoutBaseClass vNext = vIter.hasNext() ? vIter.next() : null;
+		CppCompositeType vBase = vNext != null ? vNext.getBaseClassType() : null;
+		ClassID vId = vBase != null ? vBase.getClassId() : null;
+
+		List<LayoutBaseClass> sourceOrderBases = new ArrayList<>();
+
+		BaseOrderingState state = new BaseOrderingState();
+		while (dId != null || vId != null) {
+			if (baseMatches(state, dId, false)) {
+				sourceOrderBases.add(dNext);
+				dNext = dIter.hasNext() ? dIter.next() : null;
+				dBase = dNext != null ? dNext.getBaseClassType() : null;
+				dId = dBase != null ? dBase.getClassId() : null;
+			}
+			else if (baseMatches(state, vId, true)) {
+				sourceOrderBases.add(vNext);
+				vNext = vIter.hasNext() ? vIter.next() : null;
+				vBase = vNext != null ? vNext.getBaseClassType() : null;
+				vId = vBase != null ? vBase.getClassId() : null;
+			}
+			else {
+				throw new PdbException("Broken algorithm");
+			}
+		}
+
+		StringBuilder builder = new StringBuilder();
+		for (LayoutBaseClass b : sourceOrderBases) {
+			if (!builder.isEmpty()) {
+				builder.append(", ");
+			}
+			if (b instanceof DirectVirtualLayoutBaseClass) {
+				builder.append("virtual ");
+			}
+			builder.append(b.getBaseClassType().getClassId().getSymbolPath());
+		}
+		if (!builder.isEmpty()) {
+			result.append(" : ");
+			result.append(builder);
+		}
+		return result.toString();
+	}
+
+	private class BaseOrderingState {
+
+		List<ClassID> orderedBaseIds;
+		int baseStartIndex;
+		Set<ClassID> consumedVirtualClassIds;
+		List<ClassID> orderedDirectBaseIds;
+		int directIndex;
+		List<ClassID> orderedDirectVirtualBaseIds;
+		int virtualIndex;
+
+		BaseOrderingState() throws PdbException {
+			TreeMap<Long, List<VirtualBaseTableEntry>> orderedBases = new TreeMap<>();
+			if (mainVbt != null) {
+				for (int index = 1; index <= mainVbt.getNumEntries(); index++) {
+					VirtualBaseTableEntry e = (VirtualBaseTableEntry) mainVbt.getEntry(index);
+					Long offset = mainVbt.getBaseOffset(index);
+					List<VirtualBaseTableEntry> list = orderedBases.get(offset);
+					if (list == null) {
+						list = new ArrayList<>();
+						orderedBases.put(offset, list);
+					}
+					list.add(e);
+				}
+			}
+			orderedBaseIds = new ArrayList<>();
+			for (List<VirtualBaseTableEntry> list : orderedBases.values()) {
+				for (VirtualBaseTableEntry e : list) {
+					orderedBaseIds.add(e.getClassId());
+				}
+			}
+			baseStartIndex = 0;
+			consumedVirtualClassIds = new HashSet<>();
+			orderedDirectBaseIds = new ArrayList<>(orderedVirtualBasesForDirectBase.keySet());
+			orderedDirectVirtualBaseIds =
+				new ArrayList<>(orderedVirtualBasesForDirectVirtualBase.keySet());
+			directIndex = 0;
+			virtualIndex = 0;
+		}
+	}
+
+	private boolean baseMatches(BaseOrderingState state, ClassID testId, boolean isVirtualBase) {
+
+		if (testId == null) {
+			return false;
+		}
+
+		List<ClassID> orderedTestBaseIds;
+		LinkedHashMap<ClassID, List<ClassID>> vBaseIdsUsedByBase;
+		int bIndex;
+		if (isVirtualBase) {
+			vBaseIdsUsedByBase = orderedVirtualBasesForDirectVirtualBase;
+			orderedTestBaseIds = state.orderedDirectVirtualBaseIds;
+			bIndex = state.virtualIndex;
+		}
+		else {
+			vBaseIdsUsedByBase = orderedVirtualBasesForDirectBase;
+			orderedTestBaseIds = state.orderedDirectBaseIds;
+			bIndex = state.directIndex;
+		}
+
+		ClassID id = bIndex >= orderedTestBaseIds.size() ? null : orderedTestBaseIds.get(bIndex);
+		if (!testId.equals(id)) {
+			return false;
+		}
+
+		List<ClassID> orderedNeededIds = new ArrayList<>();
+		for (ClassID baseId : vBaseIdsUsedByBase.get(testId)) {
+			if (state.consumedVirtualClassIds.contains(baseId)) {
+				continue;
+			}
+			orderedNeededIds.add(baseId);
+		}
+
+		int nSize = orderedNeededIds.size();
+		if (state.baseStartIndex + nSize >= state.orderedBaseIds.size()) {
+			// throw... not enough
+		}
+
+		for (int index = 0; index < nSize; index++) {
+			if (orderedNeededIds.get(index)
+					.equals(state.orderedBaseIds.get(state.baseStartIndex + index))) {
+				continue;
+			}
+			return false;
+		}
+		bIndex++;
+		state.baseStartIndex += nSize;
+		state.consumedVirtualClassIds.addAll(orderedNeededIds);
+
+		if (isVirtualBase) {
+			state.virtualIndex = bIndex;
+		}
+		else {
+			state.directIndex = bIndex;
+		}
 
+		return true;
 	}
 
 	/**
@@ -1061,6 +1238,7 @@ private void createClassLayout(MsVxtManager vxtManager, ObjectOrientedClassLayou
 		if (mainVft != null) {
 			updateMainVft();
 		}
+		depthFirstVirtualBases();
 		if (getNumLayoutVirtualBaseClasses() == 0) {
 			if (!DefaultCompositeMember.applyDataTypeMembers(composite, false, false, size,
 				selfBaseMembers, msg -> Msg.warn(this, msg), monitor)) {
@@ -1109,6 +1287,9 @@ private void createClassLayout(MsVxtManager vxtManager, ObjectOrientedClassLayou
 //			updateVftFromSelf(vft);
 //		}
 
+		sourceHierarchy = determineBaseSourceOrder();
+		composite.setDescription(sourceHierarchy);
+
 	}
 
 	// Taken from PdbUtil without change.  Would have had to change access on class PdbUtil and
@@ -1228,28 +1409,31 @@ private List<ClassPdbMember> getSelfBaseClassMembers() {
 	private TreeMap<Long, ClassPdbMember> getVirtualBaseClassMembers(String baseComment) {
 		TreeMap<Long, ClassPdbMember> map = new TreeMap<>();
 		String accumulatedComment = "";
-		for (VirtualLayoutBaseClass base : virtualLayoutBaseClasses) {
-			CppCompositeType baseComposite = base.getBaseClassType();
-			ClassID id = baseComposite.getClassId();
-			Long offset = baseOffsetById.get(id);
-			// Cannot do baseComposite.getSelfBaseType().isZeroLength()
-			//  or baseComposite.getComposite().isZeroLength()
-			if (!baseComposite.hasZeroBaseSize()) {
-				String comment = baseComment;
-				if (!accumulatedComment.isEmpty()) {
-					comment += " and previous " + accumulatedComment;
+		// TODO: Fix O(N2) ?
+		for (ClassID baseId : depthFirstVirtualBases.keySet()) {
+			for (VirtualLayoutBaseClass base : virtualLayoutBaseClasses) {
+				CppCompositeType baseComposite = base.getBaseClassType();
+				if (baseId.equals(baseComposite.getClassId())) {
+					Long offset = baseOffsetById.get(baseId);
+					if (!baseComposite.hasZeroBaseSize()) {
+						String comment = baseComment;
+						if (!accumulatedComment.isEmpty()) {
+							comment += " and previous " + accumulatedComment;
+						}
+						Composite baseDataType = base.getSelfBaseDataType();
+						// This does not have attributes
+						ClassPdbMember classPdbMember =
+							new ClassPdbMember("", baseDataType, false, offset.intValue(), comment);
+						map.put(offset, classPdbMember);
+						accumulatedComment = "";
+					}
+					else {
+						String comment =
+							"(Empty Virtual Base " + base.getDataTypePath().getDataTypeName() + ")";
+						accumulatedComment += comment;
+					}
+					break;
 				}
-				Composite baseDataType = base.getSelfBaseDataType();
-				// This does not have attributes
-				ClassPdbMember classPdbMember =
-					new ClassPdbMember("", baseDataType, false, offset.intValue(), comment);
-				map.put(offset, classPdbMember);
-				accumulatedComment = "";
-			}
-			else {
-				String comment =
-					"(Empty Virtual Base " + base.getDataTypePath().getDataTypeName() + ")";
-				accumulatedComment += comment;
 			}
 		}
 		return map;
@@ -1511,7 +1695,7 @@ private TreeMap<Long, ClassPdbMember> processVirtualBaseClasses(MsVxtManager vxt
 		return virtualBasePdbMembers;
 	}
 
-	private TreeMap<Long, ClassPdbMember> provideVirtualBaseFillerBytes() throws PdbException {
+	private TreeMap<Long, ClassPdbMember> provideVirtualBaseFillerBytes() {
 		TreeMap<Long, ClassPdbMember> fillerForVirtualBasePdbMembers = new TreeMap<>();
 		int numVirtualBases = virtualLayoutBaseClasses.size();
 		if (numVirtualBases == 0) {
@@ -2070,6 +2254,11 @@ private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBases() {
 			return depthFirstVirtualBases;
 		}
 		depthFirstVirtualBases = new LinkedHashMap<>();
+		depthFirstVirtualBasesFromDirectBases = new LinkedHashMap<>();
+		depthFirstVirtualBasesFromDirectVirtualBases = new LinkedHashMap<>();
+		depthFirstVirtualBasesFromIndirectVirtualBases = new LinkedHashMap<>();
+		orderedVirtualBasesForDirectBase = new LinkedHashMap<>();
+		orderedVirtualBasesForDirectVirtualBase = new LinkedHashMap<>();
 
 		for (DirectLayoutBaseClass base : directLayoutBaseClasses) {
 			CppCompositeType bt = base.getBaseClassType();
@@ -2077,10 +2266,16 @@ private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBases() {
 			// It is bad to replace an existing entry: we are counting on the parentage of the
 			//  first one that occurs.  Thus, we need to inspect and add them one at a time instead
 			//  of using addAll().
+			orderedVirtualBasesForDirectBase.put(bt.getClassId(),
+				new ArrayList<>(baseResults.keySet()));
 			for (Map.Entry<ClassID, List<ClassID>> entry : baseResults.entrySet()) {
 				if (!depthFirstVirtualBases.containsKey(entry.getKey())) {
 					depthFirstVirtualBases.put(entry.getKey(), entry.getValue());
 				}
+				if (!depthFirstVirtualBasesFromDirectBases.containsKey(entry.getKey())) {
+					depthFirstVirtualBasesFromDirectBases.put(entry.getKey(),
+						new ArrayList<>(entry.getValue()));
+				}
 			}
 		}
 		// If we have a vbt for this class in memory, we can properly place all virtual (direct
@@ -2105,24 +2300,47 @@ private LinkedHashMap<ClassID, List<ClassID>> depthFirstVirtualBases() {
 		//  memory).
 		// This algorithm is meant to try its best to help when we don't have a vbt in program
 		//  memory.
-		for (VirtualLayoutBaseClass base : virtualLayoutBaseClasses) {
+		for (VirtualLayoutBaseClass base : directVirtualLayoutBaseClasses) {
 			CppCompositeType bt = base.getBaseClassType();
+			ClassID baseId = bt.getClassId();
 			LinkedHashMap<ClassID, List<ClassID>> baseResults = bt.depthFirstVirtualBases();
 			// It is bad to replace an existing entry: we are counting on the parentage of the
 			//  first one that occurs.  Thus, we need to inspect and add them one at a time instead
 			//  of using addAll().
+			List<ClassID> list = new ArrayList<>(baseResults.keySet());
+			list.add(baseId);
+			orderedVirtualBasesForDirectVirtualBase.put(baseId, list);
 			for (Map.Entry<ClassID, List<ClassID>> entry : baseResults.entrySet()) {
 				if (!depthFirstVirtualBases.containsKey(entry.getKey())) {
 					depthFirstVirtualBases.put(entry.getKey(), entry.getValue());
 				}
+				if (!depthFirstVirtualBasesFromDirectVirtualBases.containsKey(entry.getKey())) {
+					depthFirstVirtualBasesFromDirectVirtualBases.put(entry.getKey(),
+						new ArrayList<>(entry.getValue()));
+				}
 			}
-		}
-		for (DirectVirtualLayoutBaseClass base : directVirtualLayoutBaseClasses) {
-			CppCompositeType bt = base.getBaseClassType();
-			ClassID baseId = bt.getClassId();
 			ArrayList<ClassID> baseParentage = new ArrayList<>(List.of(baseId));
 			depthFirstVirtualBases.put(baseId, baseParentage);
+			depthFirstVirtualBasesFromDirectVirtualBases.put(baseId,
+				new ArrayList<>(baseParentage));
 		}
+		for (VirtualLayoutBaseClass base : indirectVirtualLayoutBaseClasses) {
+			CppCompositeType bt = base.getBaseClassType();
+			LinkedHashMap<ClassID, List<ClassID>> baseResults = bt.depthFirstVirtualBases();
+			// It is bad to replace an existing entry: we are counting on the parentage of the
+			//  first one that occurs.  Thus, we need to inspect and add them one at a time instead
+			//  of using addAll().
+			for (Map.Entry<ClassID, List<ClassID>> entry : baseResults.entrySet()) {
+				if (!depthFirstVirtualBases.containsKey(entry.getKey())) {
+					depthFirstVirtualBases.put(entry.getKey(), entry.getValue());
+				}
+				if (!depthFirstVirtualBasesFromIndirectVirtualBases.containsKey(entry.getKey())) {
+					depthFirstVirtualBasesFromIndirectVirtualBases.put(entry.getKey(),
+						new ArrayList<>(entry.getValue()));
+				}
+			}
+		}
+
 		// add self to all parentage
 		for (List<ClassID> parentage : depthFirstVirtualBases.values()) {
 			parentage.addFirst(myId);
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb432ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb432ProgramCreator.java
index 90bd685b041..bfe9062ef5d 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb432ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb432ProgramCreator.java
@@ -900,6 +900,11 @@ private static String getSpeculatedStructA1() {
 		return convertCommentsToSpeculative(getExpectedStructA1());
 	}
 
+	private static String getExpectedSourceHierarchyA1() {
+		String expected = "struct A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[A1NS::A1]");
@@ -969,6 +974,11 @@ private static String getSpeculatedStructA2() {
 		return convertCommentsToSpeculative(getExpectedStructA2());
 	}
 
+	private static String getExpectedSourceHierarchyA2() {
+		String expected = "struct A2NS::A2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[A2NS::A2]");
@@ -1111,6 +1121,11 @@ private static String getSpeculatedStructA() {
 		return convertCommentsToSpeculative(getExpectedStructA());
 	}
 
+	private static String getExpectedSourceHierarchyA() {
+		String expected = "struct ANS::A : virtual A1NS::A1, virtual A2NS::A2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[ANS::A]");
@@ -1231,6 +1246,11 @@ private static String getSpeculatedStructB1() {
 		return convertCommentsToSpeculative(getExpectedStructB1());
 	}
 
+	private static String getExpectedSourceHierarchyB1() {
+		String expected = "struct B1NS::B1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[B1NS::B1]");
@@ -1300,6 +1320,11 @@ private static String getSpeculatedStructB2() {
 		return convertCommentsToSpeculative(getExpectedStructB2());
 	}
 
+	private static String getExpectedSourceHierarchyB2() {
+		String expected = "struct B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[B2NS::B2]");
@@ -1442,6 +1467,11 @@ private static String getSpeculatedStructB() {
 		return convertCommentsToSpeculative(getExpectedStructB());
 	}
 
+	private static String getExpectedSourceHierarchyB() {
+		String expected = "struct BNS::B : virtual B1NS::B1, virtual B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [BNS::B]	[BNS::B]");
@@ -1677,6 +1707,12 @@ private static String getSpeculatedStructC() {
 		return convertCommentsToSpeculative(getExpectedStructC());
 	}
 
+	private static String getExpectedSourceHierarchyC() {
+		String expected =
+			"struct CNS::C : virtual A1NS::A1, virtual A2NS::A2, virtual B1NS::B1, virtual B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryC() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [CNS::C]	[CNS::C]");
@@ -2028,6 +2064,11 @@ private static String getSpeculatedStructD() {
 		return convertCommentsToSpeculative(getExpectedStructD());
 	}
 
+	private static String getExpectedSourceHierarchyD() {
+		String expected = "struct DNS::D : CNS::C, ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryD() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [CNS::C]	[DNS::D, CNS::C]");
@@ -2405,6 +2446,11 @@ private static String getSpeculatedStructE() {
 		return convertCommentsToSpeculative(getExpectedStructE());
 	}
 
+	private static String getExpectedSourceHierarchyE() {
+		String expected = "struct ENS::E : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryE() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[ENS::E, ANS::A]");
@@ -2640,6 +2686,11 @@ private static String getSpeculatedStructF() {
 		return convertCommentsToSpeculative(getExpectedStructF());
 	}
 
+	private static String getExpectedSourceHierarchyF() {
+		String expected = "struct FNS::F : virtual A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryF() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[FNS::F]");
@@ -2785,6 +2836,11 @@ private static String getSpeculatedStructG() {
 		return convertCommentsToSpeculative(getExpectedStructG());
 	}
 
+	private static String getExpectedSourceHierarchyG() {
+		String expected = "struct GNS::G : FNS::F";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GNS::G, FNS::F]");
@@ -2930,6 +2986,11 @@ private static String getSpeculatedStructH() {
 		return convertCommentsToSpeculative(getExpectedStructH());
 	}
 
+	private static String getExpectedSourceHierarchyH() {
+		String expected = "struct HNS::H : FNS::F";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[HNS::H, FNS::F]");
@@ -3119,6 +3180,11 @@ private static String getSpeculatedStructI() {
 		return convertCommentsToSpeculative(getExpectedStructI());
 	}
 
+	private static String getExpectedSourceHierarchyI() {
+		String expected = "struct INS::I : GNS::G, HNS::H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [GNS::G]	[INS::I, GNS::G, FNS::F]");
@@ -3263,6 +3329,11 @@ private static String getSpeculatedStructJ() {
 		return convertCommentsToSpeculative(getExpectedStructJ());
 	}
 
+	private static String getExpectedSourceHierarchyJ() {
+		String expected = "struct JNS::J : virtual A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[JNS::J]");
@@ -3408,6 +3479,11 @@ private static String getSpeculatedStructK() {
 		return convertCommentsToSpeculative(getExpectedStructK());
 	}
 
+	private static String getExpectedSourceHierarchyK() {
+		String expected = "struct KNS::K : JNS::J";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryK() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[KNS::K, JNS::J]");
@@ -3570,6 +3646,11 @@ private static String getSpeculatedStructL() {
 		return convertCommentsToSpeculative(getExpectedStructL());
 	}
 
+	private static String getExpectedSourceHierarchyL() {
+		String expected = "struct LNS::L : KNS::K";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryL() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[LNS::L, KNS::K, JNS::J]");
@@ -3653,6 +3734,11 @@ private static String getSpeculatedStructN1() {
 		return convertCommentsToSpeculative(getExpectedStructN1());
 	}
 
+	private static String getExpectedSourceHierarchyN1() {
+		String expected = "struct N1NS::N1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryN1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[N1NS::N1]");
@@ -3719,6 +3805,11 @@ private static String getSpeculatedStructN2() {
 		return convertCommentsToSpeculative(getExpectedStructN2());
 	}
 
+	private static String getExpectedSourceHierarchyN2() {
+		String expected = "struct N2NS::N2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryN2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[N2NS::N2]");
@@ -4392,6 +4483,18 @@ private static String getSpeculatedStructM() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyM() {
+		String expected =
+			"struct MNS::M : virtual N1NS::N1, ENS::E, DNS::D, INS::I, LNS::L, virtual N2NS::N2";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyM() {
+		String expected =
+			"struct MNS::M : ENS::E, DNS::D, INS::I, LNS::L, virtual N1NS::N1, virtual N2NS::N2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryM() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A, ENS::E]	[MNS::M, ENS::E, ANS::A]");
@@ -5111,6 +5214,11 @@ private static String getSpeculatedStructO1() {
 		return convertCommentsToSpeculative(getExpectedStructO1());
 	}
 
+	private static String getExpectedSourceHierarchyO1() {
+		String expected = "struct O1NS::O1 : ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O1NS::O1, ANS::A]");
@@ -5458,6 +5566,11 @@ private static String getSpeculatedStructO2() {
 		return convertCommentsToSpeculative(getExpectedStructO2());
 	}
 
+	private static String getExpectedSourceHierarchyO2() {
+		String expected = "struct O2NS::O2 : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O2NS::O2, ANS::A]");
@@ -5813,6 +5926,11 @@ private static String getSpeculatedStructO3() {
 		return convertCommentsToSpeculative(getExpectedStructO3());
 	}
 
+	private static String getExpectedSourceHierarchyO3() {
+		String expected = "struct O3NS::O3 : ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O3NS::O3, ANS::A]");
@@ -6160,6 +6278,11 @@ private static String getSpeculatedStructO4() {
 		return convertCommentsToSpeculative(getExpectedStructO4());
 	}
 
+	private static String getExpectedSourceHierarchyO4() {
+		String expected = "struct O4NS::O4 : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O4NS::O4, ANS::A]");
@@ -6670,6 +6793,11 @@ private static String getSpeculatedStructO() {
 		return convertCommentsToSpeculative(getExpectedStructO());
 	}
 
+	private static String getExpectedSourceHierarchyO() {
+		String expected = "struct ONS::O : O1NS::O1, O2NS::O2, virtual O3NS::O3, virtual O4NS::O4";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000",
@@ -7110,6 +7238,42 @@ private static String getVxtStructO_0000007c() {
 		speculatedStructs.put(O, getSpeculatedStructO());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(A1, getExpectedSourceHierarchyA1());
+		expectedSourceHierarchy.put(A2, getExpectedSourceHierarchyA2());
+		expectedSourceHierarchy.put(A, getExpectedSourceHierarchyA());
+		expectedSourceHierarchy.put(B1, getExpectedSourceHierarchyB1());
+		expectedSourceHierarchy.put(B2, getExpectedSourceHierarchyB2());
+		expectedSourceHierarchy.put(B, getExpectedSourceHierarchyB());
+		expectedSourceHierarchy.put(C, getExpectedSourceHierarchyC());
+		expectedSourceHierarchy.put(D, getExpectedSourceHierarchyD());
+		expectedSourceHierarchy.put(E, getExpectedSourceHierarchyE());
+		expectedSourceHierarchy.put(F, getExpectedSourceHierarchyF());
+		expectedSourceHierarchy.put(G, getExpectedSourceHierarchyG());
+		expectedSourceHierarchy.put(H, getExpectedSourceHierarchyH());
+		expectedSourceHierarchy.put(I, getExpectedSourceHierarchyI());
+		expectedSourceHierarchy.put(J, getExpectedSourceHierarchyJ());
+		expectedSourceHierarchy.put(K, getExpectedSourceHierarchyK());
+		expectedSourceHierarchy.put(L, getExpectedSourceHierarchyL());
+		expectedSourceHierarchy.put(N1, getExpectedSourceHierarchyN1());
+		expectedSourceHierarchy.put(N2, getExpectedSourceHierarchyN2());
+		expectedSourceHierarchy.put(M, getExpectedSourceHierarchyM());
+		expectedSourceHierarchy.put(O1, getExpectedSourceHierarchyO1());
+		expectedSourceHierarchy.put(O2, getExpectedSourceHierarchyO2());
+		expectedSourceHierarchy.put(O3, getExpectedSourceHierarchyO3());
+		expectedSourceHierarchy.put(O4, getExpectedSourceHierarchyO4());
+		expectedSourceHierarchy.put(O, getExpectedSourceHierarchyO());
+	}
+
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+		// The following will replace entries as needed
+		speculatedSourceHierarchy.put(M, getSpeculatedSourceHierarchyM());
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new LinkedHashMap<>();
 	static {
@@ -7335,6 +7499,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb464ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb464ProgramCreator.java
index 3c04825e3d8..3c74e37ab0a 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb464ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Cfb464ProgramCreator.java
@@ -935,6 +935,11 @@ private static String getSpeculatedStructA1() {
 		return convertCommentsToSpeculative(getExpectedStructA1());
 	}
 
+	private static String getExpectedSourceHierarchyA1() {
+		String expected = "struct A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[A1NS::A1]");
@@ -1005,6 +1010,11 @@ private static String getSpeculatedStructA2() {
 		return convertCommentsToSpeculative(getExpectedStructA2());
 	}
 
+	private static String getExpectedSourceHierarchyA2() {
+		String expected = "struct A2NS::A2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[A2NS::A2]");
@@ -1150,6 +1160,11 @@ private static String getSpeculatedStructA() {
 		return convertCommentsToSpeculative(getExpectedStructA());
 	}
 
+	private static String getExpectedSourceHierarchyA() {
+		String expected = "struct ANS::A : virtual A1NS::A1, virtual A2NS::A2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[ANS::A]");
@@ -1271,6 +1286,11 @@ private static String getSpeculatedStructB1() {
 		return convertCommentsToSpeculative(getExpectedStructB1());
 	}
 
+	private static String getExpectedSourceHierarchyB1() {
+		String expected = "struct B1NS::B1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[B1NS::B1]");
@@ -1341,6 +1361,11 @@ private static String getSpeculatedStructB2() {
 		return convertCommentsToSpeculative(getExpectedStructB2());
 	}
 
+	private static String getExpectedSourceHierarchyB2() {
+		String expected = "struct B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[B2NS::B2]");
@@ -1486,6 +1511,11 @@ private static String getSpeculatedStructB() {
 		return convertCommentsToSpeculative(getExpectedStructB());
 	}
 
+	private static String getExpectedSourceHierarchyB() {
+		String expected = "struct BNS::B : virtual B1NS::B1, virtual B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [BNS::B]	[BNS::B]");
@@ -1726,6 +1756,12 @@ private static String getSpeculatedStructC() {
 		return convertCommentsToSpeculative(getExpectedStructC());
 	}
 
+	private static String getExpectedSourceHierarchyC() {
+		String expected =
+			"struct CNS::C : virtual A1NS::A1, virtual A2NS::A2, virtual B1NS::B1, virtual B2NS::B2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryC() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [CNS::C]	[CNS::C]");
@@ -2085,6 +2121,11 @@ private static String getSpeculatedStructD() {
 		return convertCommentsToSpeculative(getExpectedStructD());
 	}
 
+	private static String getExpectedSourceHierarchyD() {
+		String expected = "struct DNS::D : CNS::C, ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryD() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [CNS::C]	[DNS::D, CNS::C]");
@@ -2469,6 +2510,11 @@ private static String getSpeculatedStructE() {
 		return convertCommentsToSpeculative(getExpectedStructE());
 	}
 
+	private static String getExpectedSourceHierarchyE() {
+		String expected = "struct ENS::E : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryE() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[ENS::E, ANS::A]");
@@ -2706,6 +2752,11 @@ private static String getSpeculatedStructF() {
 		return convertCommentsToSpeculative(getExpectedStructF());
 	}
 
+	private static String getExpectedSourceHierarchyF() {
+		String expected = "struct FNS::F : virtual A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryF() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[FNS::F]");
@@ -2854,6 +2905,11 @@ private static String getSpeculatedStructG() {
 		return convertCommentsToSpeculative(getExpectedStructG());
 	}
 
+	private static String getExpectedSourceHierarchyG() {
+		String expected = "struct GNS::G : FNS::F";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GNS::G, FNS::F]");
@@ -3002,6 +3058,11 @@ private static String getSpeculatedStructH() {
 		return convertCommentsToSpeculative(getExpectedStructH());
 	}
 
+	private static String getExpectedSourceHierarchyH() {
+		String expected = "struct HNS::H : FNS::F";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[HNS::H, FNS::F]");
@@ -3197,6 +3258,11 @@ private static String getSpeculatedStructI() {
 		return convertCommentsToSpeculative(getExpectedStructI());
 	}
 
+	private static String getExpectedSourceHierarchyI() {
+		String expected = "struct INS::I : GNS::G, HNS::H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [GNS::G]	[INS::I, GNS::G, FNS::F]");
@@ -3343,6 +3409,11 @@ private static String getSpeculatedStructJ() {
 		return convertCommentsToSpeculative(getExpectedStructJ());
 	}
 
+	private static String getExpectedSourceHierarchyJ() {
+		String expected = "struct JNS::J : virtual A1NS::A1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[JNS::J]");
@@ -3491,6 +3562,11 @@ private static String getSpeculatedStructK() {
 		return convertCommentsToSpeculative(getExpectedStructK());
 	}
 
+	private static String getExpectedSourceHierarchyK() {
+		String expected = "struct KNS::K : JNS::J";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryK() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[KNS::K, JNS::J]");
@@ -3657,6 +3733,11 @@ private static String getSpeculatedStructL() {
 		return convertCommentsToSpeculative(getExpectedStructL());
 	}
 
+	private static String getExpectedSourceHierarchyL() {
+		String expected = "struct LNS::L : KNS::K";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryL() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[LNS::L, KNS::K, JNS::J]");
@@ -3741,6 +3822,11 @@ private static String getSpeculatedStructN1() {
 		return convertCommentsToSpeculative(getExpectedStructN1());
 	}
 
+	private static String getExpectedSourceHierarchyN1() {
+		String expected = "struct N1NS::N1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryN1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[N1NS::N1]");
@@ -3808,6 +3894,11 @@ private static String getSpeculatedStructN2() {
 		return convertCommentsToSpeculative(getExpectedStructN2());
 	}
 
+	private static String getExpectedSourceHierarchyN2() {
+		String expected = "struct N2NS::N2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryN2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[N2NS::N2]");
@@ -4503,6 +4594,18 @@ private static String getSpeculatedStructM() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyM() {
+		String expected =
+			"struct MNS::M : virtual N1NS::N1, ENS::E, DNS::D, INS::I, LNS::L, virtual N2NS::N2";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyM() {
+		String expected =
+			"struct MNS::M : ENS::E, DNS::D, INS::I, LNS::L, virtual N1NS::N1, virtual N2NS::N2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryM() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A, ENS::E]	[MNS::M, ENS::E, ANS::A]");
@@ -5229,6 +5332,11 @@ private static String getSpeculatedStructO1() {
 		return convertCommentsToSpeculative(getExpectedStructO1());
 	}
 
+	private static String getExpectedSourceHierarchyO1() {
+		String expected = "struct O1NS::O1 : ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O1NS::O1, ANS::A]");
@@ -5583,6 +5691,11 @@ private static String getSpeculatedStructO2() {
 		return convertCommentsToSpeculative(getExpectedStructO2());
 	}
 
+	private static String getExpectedSourceHierarchyO2() {
+		String expected = "struct O2NS::O2 : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O2NS::O2, ANS::A]");
@@ -5945,6 +6058,11 @@ private static String getSpeculatedStructO3() {
 		return convertCommentsToSpeculative(getExpectedStructO3());
 	}
 
+	private static String getExpectedSourceHierarchyO3() {
+		String expected = "struct O3NS::O3 : ANS::A, BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O3NS::O3, ANS::A]");
@@ -6299,6 +6417,11 @@ private static String getSpeculatedStructO4() {
 		return convertCommentsToSpeculative(getExpectedStructO4());
 	}
 
+	private static String getExpectedSourceHierarchyO4() {
+		String expected = "struct O4NS::O4 : ANS::A, virtual BNS::B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [ANS::A]	[O4NS::O4, ANS::A]");
@@ -6809,6 +6932,11 @@ private static String getSpeculatedStructO() {
 		return convertCommentsToSpeculative(getExpectedStructO());
 	}
 
+	private static String getExpectedSourceHierarchyO() {
+		String expected = "struct ONS::O : O1NS::O1, O2NS::O2, virtual O3NS::O3, virtual O4NS::O4";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryO() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000",
@@ -7249,6 +7377,42 @@ private static String getVxtStructO_000000f8() {
 		speculatedStructs.put(O, getSpeculatedStructO());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(A1, getExpectedSourceHierarchyA1());
+		expectedSourceHierarchy.put(A2, getExpectedSourceHierarchyA2());
+		expectedSourceHierarchy.put(A, getExpectedSourceHierarchyA());
+		expectedSourceHierarchy.put(B1, getExpectedSourceHierarchyB1());
+		expectedSourceHierarchy.put(B2, getExpectedSourceHierarchyB2());
+		expectedSourceHierarchy.put(B, getExpectedSourceHierarchyB());
+		expectedSourceHierarchy.put(C, getExpectedSourceHierarchyC());
+		expectedSourceHierarchy.put(D, getExpectedSourceHierarchyD());
+		expectedSourceHierarchy.put(E, getExpectedSourceHierarchyE());
+		expectedSourceHierarchy.put(F, getExpectedSourceHierarchyF());
+		expectedSourceHierarchy.put(G, getExpectedSourceHierarchyG());
+		expectedSourceHierarchy.put(H, getExpectedSourceHierarchyH());
+		expectedSourceHierarchy.put(I, getExpectedSourceHierarchyI());
+		expectedSourceHierarchy.put(J, getExpectedSourceHierarchyJ());
+		expectedSourceHierarchy.put(K, getExpectedSourceHierarchyK());
+		expectedSourceHierarchy.put(L, getExpectedSourceHierarchyL());
+		expectedSourceHierarchy.put(N1, getExpectedSourceHierarchyN1());
+		expectedSourceHierarchy.put(N2, getExpectedSourceHierarchyN2());
+		expectedSourceHierarchy.put(M, getExpectedSourceHierarchyM());
+		expectedSourceHierarchy.put(O1, getExpectedSourceHierarchyO1());
+		expectedSourceHierarchy.put(O2, getExpectedSourceHierarchyO2());
+		expectedSourceHierarchy.put(O3, getExpectedSourceHierarchyO3());
+		expectedSourceHierarchy.put(O4, getExpectedSourceHierarchyO4());
+		expectedSourceHierarchy.put(O, getExpectedSourceHierarchyO());
+	}
+
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+		// The following will replace entries as needed
+		speculatedSourceHierarchy.put(M, getSpeculatedSourceHierarchyM());
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new LinkedHashMap<>();
 	static {
@@ -7474,6 +7638,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray832ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray832ProgramCreator.java
index 14e783798e1..93641bde0b4 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray832ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray832ProgramCreator.java
@@ -2010,6 +2010,11 @@ private static String getSpeculatedStructA() {
 		return convertCommentsToSpeculative(getExpectedStructA());
 	}
 
+	private static String getExpectedSourceHierarchyA() {
+		String expected = "struct A";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2066,6 +2071,11 @@ private static String getSpeculatedStructB() {
 		return convertCommentsToSpeculative(getExpectedStructB());
 	}
 
+	private static String getExpectedSourceHierarchyB() {
+		String expected = "struct B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2109,6 +2119,11 @@ private static String getSpeculatedStructC() {
 		return convertCommentsToSpeculative(getExpectedStructC());
 	}
 
+	private static String getExpectedSourceHierarchyC() {
+		String expected = "struct C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryC() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2152,6 +2167,11 @@ private static String getSpeculatedStructCC1() {
 		return convertCommentsToSpeculative(getExpectedStructCC1());
 	}
 
+	private static String getExpectedSourceHierarchyCC1() {
+		String expected = "struct CC1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2195,6 +2215,11 @@ private static String getSpeculatedStructCC2() {
 		return convertCommentsToSpeculative(getExpectedStructCC2());
 	}
 
+	private static String getExpectedSourceHierarchyCC2() {
+		String expected = "struct CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2235,6 +2260,11 @@ private static String getSpeculatedStructCC3() {
 		return convertCommentsToSpeculative(getExpectedStructCC3());
 	}
 
+	private static String getExpectedSourceHierarchyCC3() {
+		String expected = "struct CC3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC3() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2288,6 +2318,11 @@ private static String getSpeculatedStructD() {
 		return convertCommentsToSpeculative(getExpectedStructD());
 	}
 
+	private static String getExpectedSourceHierarchyD() {
+		String expected = "struct D : C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryD() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2331,6 +2366,11 @@ private static String getSpeculatedStructE() {
 		return convertCommentsToSpeculative(getExpectedStructE());
 	}
 
+	private static String getExpectedSourceHierarchyE() {
+		String expected = "struct E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryE() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2394,6 +2434,11 @@ private static String getSpeculatedStructF() {
 		return convertCommentsToSpeculative(getExpectedStructF());
 	}
 
+	private static String getExpectedSourceHierarchyF() {
+		String expected = "struct F : C, E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryF() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2483,6 +2528,11 @@ private static String getSpeculatedStructG() {
 		return convertCommentsToSpeculative(getExpectedStructG());
 	}
 
+	private static String getExpectedSourceHierarchyG() {
+		String expected = "struct G : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[G]");
@@ -2588,6 +2638,11 @@ private static String getSpeculatedStructH() {
 		return convertCommentsToSpeculative(getExpectedStructH());
 	}
 
+	private static String getExpectedSourceHierarchyH() {
+		String expected = "struct H : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[H]");
@@ -2693,6 +2748,11 @@ private static String getSpeculatedStructGG1() {
 		return convertCommentsToSpeculative(getExpectedStructGG1());
 	}
 
+	private static String getExpectedSourceHierarchyGG1() {
+		String expected = "struct GG1 : virtual CC1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG1]");
@@ -2798,6 +2858,11 @@ private static String getSpeculatedStructGG2() {
 		return convertCommentsToSpeculative(getExpectedStructGG2());
 	}
 
+	private static String getExpectedSourceHierarchyGG2() {
+		String expected = "struct GG2 : virtual CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG2]");
@@ -2903,6 +2968,11 @@ private static String getSpeculatedStructGG3() {
 		return convertCommentsToSpeculative(getExpectedStructGG3());
 	}
 
+	private static String getExpectedSourceHierarchyGG3() {
+		String expected = "struct GG3 : virtual CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG3]");
@@ -3004,6 +3074,11 @@ private static String getSpeculatedStructGG4() {
 		return convertCommentsToSpeculative(getExpectedStructGG4());
 	}
 
+	private static String getExpectedSourceHierarchyGG4() {
+		String expected = "struct GG4 : virtual CC3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG4]");
@@ -3150,6 +3225,11 @@ private static String getSpeculatedStructI() {
 		return convertCommentsToSpeculative(getExpectedStructI());
 	}
 
+	private static String getExpectedSourceHierarchyI() {
+		String expected = "struct I : G, H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[I, G]");
@@ -3263,6 +3343,11 @@ private static String getSpeculatedStructGX1() {
 		return convertCommentsToSpeculative(getExpectedStructGX1());
 	}
 
+	private static String getExpectedSourceHierarchyGX1() {
+		String expected = "struct GX1 : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GX1]");
@@ -3362,6 +3447,11 @@ private static String getSpeculatedStructHX1() {
 		return convertCommentsToSpeculative(getExpectedStructHX1());
 	}
 
+	private static String getExpectedSourceHierarchyHX1() {
+		String expected = "struct HX1 : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryHX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[HX1]");
@@ -3497,6 +3587,11 @@ private static String getSpeculatedStructIX1() {
 		return convertCommentsToSpeculative(getExpectedStructIX1());
 	}
 
+	private static String getExpectedSourceHierarchyIX1() {
+		String expected = "struct IX1 : GX1, HX1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryIX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [GX1]	[IX1, GX1]");
@@ -3630,6 +3725,11 @@ private static String getSpeculatedStructG1() {
 		return convertCommentsToSpeculative(getExpectedStructG1());
 	}
 
+	private static String getExpectedSourceHierarchyG1() {
+		String expected = "struct G1 : virtual C, virtual E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[G1]");
@@ -3748,6 +3848,11 @@ private static String getSpeculatedStructH1() {
 		return convertCommentsToSpeculative(getExpectedStructH1());
 	}
 
+	private static String getExpectedSourceHierarchyH1() {
+		String expected = "struct H1 : virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[H1]");
@@ -3907,6 +4012,11 @@ private static String getSpeculatedStructI1() {
 		return convertCommentsToSpeculative(getExpectedStructI1());
 	}
 
+	private static String getExpectedSourceHierarchyI1() {
+		String expected = "struct I1 : G1, H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[I1, G1]");
@@ -4083,6 +4193,11 @@ private static String getSpeculatedStructI2() {
 		return convertCommentsToSpeculative(getExpectedStructI2());
 	}
 
+	private static String getExpectedSourceHierarchyI2() {
+		String expected = "struct I2 : G, H1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[I2, G]");
@@ -4260,6 +4375,11 @@ private static String getSpeculatedStructI3() {
 		return convertCommentsToSpeculative(getExpectedStructI3());
 	}
 
+	private static String getExpectedSourceHierarchyI3() {
+		String expected = "struct I3 : G1, H1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[I3, G1]");
@@ -4412,6 +4532,11 @@ private static String getSpeculatedStructI4() {
 		return convertCommentsToSpeculative(getExpectedStructI4());
 	}
 
+	private static String getExpectedSourceHierarchyI4() {
+		String expected = "struct I4 : G1, virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[I4, G1]");
@@ -4597,6 +4722,16 @@ private static String getSpeculatedStructI5() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyI5() {
+		String expected = "struct I5 : virtual E, G1, virtual C";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyI5() {
+		String expected = "struct I5 : G1, virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[I5, G1]");
@@ -4840,6 +4975,11 @@ private static String getSpeculatedStructJ1() {
 		return convertCommentsToSpeculative(getExpectedStructJ1());
 	}
 
+	private static String getExpectedSourceHierarchyJ1() {
+		String expected = "struct J1 : I1, I2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J1, I1, G1]");
@@ -5133,6 +5273,11 @@ private static String getSpeculatedStructJ2() {
 		return convertCommentsToSpeculative(getExpectedStructJ2());
 	}
 
+	private static String getExpectedSourceHierarchyJ2() {
+		String expected = "struct J2 : I2, I1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[J2, I2, G]");
@@ -5447,6 +5592,11 @@ private static String getSpeculatedStructJ3() {
 		return convertCommentsToSpeculative(getExpectedStructJ3());
 	}
 
+	private static String getExpectedSourceHierarchyJ3() {
+		String expected = "struct J3 : I2, I1, A";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[J3, I2, G]");
@@ -5844,6 +5994,11 @@ private static String getSpeculatedStructJ4() {
 		return convertCommentsToSpeculative(getExpectedStructJ4());
 	}
 
+	private static String getExpectedSourceHierarchyJ4() {
+		String expected = "struct J4 : I3, GG1, I, A, virtual GG2, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J4, I3, G1]");
@@ -6333,6 +6488,16 @@ private static String getSpeculatedStructJ5() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyJ5() {
+		String expected = "struct J5 : virtual GG2, virtual GG3, I3, GG1, I, A";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyJ5() {
+		String expected = "struct J5 : I3, GG1, I, A, virtual GG2, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J5, I3, G1]");
@@ -6575,8 +6740,8 @@ private static String getExpectedStructJ6() {
 			pack()
 			Structure J6 {
 			   0   J6   16      "Self Base"
-			   16   GG4   8      "Virtual Base"
-			   24   CC2   4      "Virtual Base and previous (Empty Virtual Base CC3)"
+			   16   GG4   8      "Virtual Base and previous (Empty Virtual Base CC3)"
+			   24   CC2   4      "Virtual Base"
 			   28   GG3   8      "Virtual Base"
 			}
 			Length: 36 Alignment: 4
@@ -6651,8 +6816,7 @@ private static String getFillerStructJ6() {
 		return expected;
 	}
 
-	// TODO: Need to work on layout algorithm... believe we can do better, but don't have
-	//  a decision on the best speculative results yet.
+	//@formatter:on
 	private static String getSpeculatedStructJ6() {
 		String expected =
 		//@formatter:off
@@ -6661,8 +6825,8 @@ private static String getSpeculatedStructJ6() {
 			pack()
 			Structure J6 {
 			   0   J6   16      "Self Base"
-			   16   CC2   4      "Virtual Base - Speculative Placement and previous (Empty Virtual Base CC3)"
-			   20   GG4   8      "Virtual Base - Speculative Placement"
+			   16   GG4   8      "Virtual Base - Speculative Placement and previous (Empty Virtual Base CC3)"
+			   24   CC2   4      "Virtual Base - Speculative Placement"
 			   28   GG3   8      "Virtual Base - Speculative Placement"
 			}
 			Length: 36 Alignment: 4
@@ -6701,10 +6865,16 @@ private static String getSpeculatedStructJ6() {
 			   12   int   4   j61   ""
 			}
 			Length: 16 Alignment: 4""";
+
 		//@formatter:on
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyJ6() {
+		String expected = "struct J6 : A, virtual GG4, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ6() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [J6]	[J6]");
@@ -6833,6 +7003,11 @@ private static String getSpeculatedStructP() {
 		return convertCommentsToSpeculative(getExpectedStructP());
 	}
 
+	private static String getExpectedSourceHierarchyP() {
+		String expected = "struct P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P]");
@@ -6908,6 +7083,11 @@ private static String getSpeculatedStructQ() {
 		return convertCommentsToSpeculative(getExpectedStructQ());
 	}
 
+	private static String getExpectedSourceHierarchyQ() {
+		String expected = "struct Q : P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[Q, P]");
@@ -6974,6 +7154,11 @@ private static String getSpeculatedStructR() {
 		return convertCommentsToSpeculative(getExpectedStructR());
 	}
 
+	private static String getExpectedSourceHierarchyR() {
+		String expected = "struct R";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryR() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[R]");
@@ -7068,6 +7253,11 @@ private static String getSpeculatedStructS() {
 		return convertCommentsToSpeculative(getExpectedStructS());
 	}
 
+	private static String getExpectedSourceHierarchyS() {
+		String expected = "struct S : P, R";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryS() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P]	[S, P]");
@@ -7230,6 +7420,11 @@ private static String getSpeculatedStructT() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyT() {
+		String expected = "struct T : virtual P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryT() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [T]	[T]");
@@ -7454,6 +7649,11 @@ private static String getSpeculatedStructU() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyU() {
+		String expected = "struct U : T";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryU() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [T]	[U, T]");
@@ -7575,6 +7775,11 @@ private static String getSpeculatedStructV() {
 		return convertCommentsToSpeculative(getExpectedStructV());
 	}
 
+	private static String getExpectedSourceHierarchyV() {
+		String expected = "struct V";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryV() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[V]");
@@ -7646,6 +7851,11 @@ private static String getSpeculatedStructW() {
 		return convertCommentsToSpeculative(getExpectedStructW());
 	}
 
+	private static String getExpectedSourceHierarchyW() {
+		String expected = "struct W : V";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryW() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[W, V]");
@@ -7727,6 +7937,11 @@ private static String getSpeculatedStructWW() {
 		return convertCommentsToSpeculative(getExpectedStructWW());
 	}
 
+	private static String getExpectedSourceHierarchyWW() {
+		String expected = "struct WW : W";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryWW() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[WW, W, V]");
@@ -7779,6 +7994,11 @@ private static String getSpeculatedStructX() {
 		return convertCommentsToSpeculative(getExpectedStructX());
 	}
 
+	private static String getExpectedSourceHierarchyX() {
+		String expected = "struct X";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryX() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7815,6 +8035,11 @@ private static String getSpeculatedStructZ() {
 		return convertCommentsToSpeculative(getExpectedStructZ());
 	}
 
+	private static String getExpectedSourceHierarchyZ() {
+		String expected = "struct Z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryZ() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7853,6 +8078,11 @@ private static String getSpeculatedStructAA1a() {
 		return convertCommentsToSpeculative(getExpectedStructAA1a());
 	}
 
+	private static String getExpectedSourceHierarchyAA1a() {
+		String expected = "struct AA1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7891,6 +8121,11 @@ private static String getSpeculatedStructAA1b() {
 		return convertCommentsToSpeculative(getExpectedStructAA1b());
 	}
 
+	private static String getExpectedSourceHierarchyAA1b() {
+		String expected = "struct AA1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7949,6 +8184,11 @@ private static String getSpeculatedStructAA1() {
 		return convertCommentsToSpeculative(getExpectedStructAA1());
 	}
 
+	private static String getExpectedSourceHierarchyAA1() {
+		String expected = "struct AA1 : AA1a, AA1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7987,6 +8227,11 @@ private static String getSpeculatedStructAA2a() {
 		return convertCommentsToSpeculative(getExpectedStructAA2a());
 	}
 
+	private static String getExpectedSourceHierarchyAA2a() {
+		String expected = "struct AA2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8025,6 +8270,11 @@ private static String getSpeculatedStructAA2b() {
 		return convertCommentsToSpeculative(getExpectedStructAA2b());
 	}
 
+	private static String getExpectedSourceHierarchyAA2b() {
+		String expected = "struct AA2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8083,6 +8333,11 @@ private static String getSpeculatedStructAA2() {
 		return convertCommentsToSpeculative(getExpectedStructAA2());
 	}
 
+	private static String getExpectedSourceHierarchyAA2() {
+		String expected = "struct AA2 : AA2a, AA2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8187,6 +8442,11 @@ private static String getSpeculatedStructAA3a() {
 		return convertCommentsToSpeculative(getExpectedStructAA3a());
 	}
 
+	private static String getExpectedSourceHierarchyAA3a() {
+		String expected = "struct AA3a : virtual AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3a]");
@@ -8307,6 +8567,11 @@ private static String getSpeculatedStructAA3b() {
 		return convertCommentsToSpeculative(getExpectedStructAA3b());
 	}
 
+	private static String getExpectedSourceHierarchyAA3b() {
+		String expected = "struct AA3b : virtual AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3b]");
@@ -8574,6 +8839,16 @@ private static String getSpeculatedStructAA3c() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyAA3c() {
+		String expected = "struct AA3c : virtual AA1, AA3a, AA3b";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyAA3c() {
+		String expected = "struct AA3c : AA3a, AA3b, virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA3a]	[AA3c, AA3a]");
@@ -8783,8 +9058,8 @@ private static String getSpeculatedStructAA3d() {
 			pack()
 			Structure AA3d {
 			   0   AA3d   8      "Self Base"
-			   8   AA2   12      "Virtual Base - Speculative Placement"
-			   20   AA1   12      "Virtual Base - Speculative Placement"
+			   8   AA1   12      "Virtual Base - Speculative Placement"
+			   20   AA2   12      "Virtual Base - Speculative Placement"
 			   32   AA3a   8      "Virtual Base - Speculative Placement"
 			   40   AA3b   8      "Virtual Base - Speculative Placement"
 			}
@@ -8854,6 +9129,11 @@ private static String getSpeculatedStructAA3d() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyAA3d() {
+		String expected = "struct AA3d : virtual AA1, virtual AA3a, virtual AA3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA3d]	[AA3d]");
@@ -8973,6 +9253,11 @@ private static String getSpeculatedStructAA3e() {
 		return convertCommentsToSpeculative(getExpectedStructAA3e());
 	}
 
+	private static String getExpectedSourceHierarchyAA3e() {
+		String expected = "struct AA3e : AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -9041,6 +9326,11 @@ private static String getSpeculatedStructAA3f() {
 		return convertCommentsToSpeculative(getExpectedStructAA3f());
 	}
 
+	private static String getExpectedSourceHierarchyAA3f() {
+		String expected = "struct AA3f : AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -9177,6 +9467,11 @@ private static String getSpeculatedStructAA3g() {
 		return convertCommentsToSpeculative(getExpectedStructAA3g());
 	}
 
+	private static String getExpectedSourceHierarchyAA3g() {
+		String expected = "struct AA3g : virtual AA3e, virtual AA3f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3g]");
@@ -9298,6 +9593,11 @@ private static String getSpeculatedStructAA4a() {
 		return convertCommentsToSpeculative(getExpectedStructAA4a());
 	}
 
+	private static String getExpectedSourceHierarchyAA4a() {
+		String expected = "struct AA4a : virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4a]");
@@ -9418,6 +9718,11 @@ private static String getSpeculatedStructAA4b() {
 		return convertCommentsToSpeculative(getExpectedStructAA4b());
 	}
 
+	private static String getExpectedSourceHierarchyAA4b() {
+		String expected = "struct AA4b : virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4b]");
@@ -9579,6 +9884,11 @@ private static String getSpeculatedStructAA4c() {
 		return convertCommentsToSpeculative(getExpectedStructAA4c());
 	}
 
+	private static String getExpectedSourceHierarchyAA4c() {
+		String expected = "struct AA4c : AA4a, AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4a]	[AA4c, AA4a]");
@@ -9750,6 +10060,11 @@ private static String getSpeculatedStructAA4d() {
 		return convertCommentsToSpeculative(getExpectedStructAA4d());
 	}
 
+	private static String getExpectedSourceHierarchyAA4d() {
+		String expected = "struct AA4d : AA4b, virtual AA4a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4b]	[AA4d, AA4b]");
@@ -9922,6 +10237,11 @@ private static String getSpeculatedStructAA4e() {
 		return convertCommentsToSpeculative(getExpectedStructAA4e());
 	}
 
+	private static String getExpectedSourceHierarchyAA4e() {
+		String expected = "struct AA4e : AA4a, virtual AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4a]	[AA4e, AA4a]");
@@ -10095,6 +10415,11 @@ private static String getSpeculatedStructAA4f() {
 		return convertCommentsToSpeculative(getExpectedStructAA4f());
 	}
 
+	private static String getExpectedSourceHierarchyAA4f() {
+		String expected = "struct AA4f : virtual AA4a, virtual AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4f]	[AA4f]");
@@ -10266,6 +10591,11 @@ private static String getSpeculatedStructAA4g() {
 		return convertCommentsToSpeculative(getExpectedStructAA4g());
 	}
 
+	private static String getExpectedSourceHierarchyAA4g() {
+		String expected = "struct AA4g : AA4b, virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4g, AA4b]");
@@ -10320,6 +10650,11 @@ private static String getSpeculatedStructAA4h() {
 		return convertCommentsToSpeculative(getExpectedStructAA4h());
 	}
 
+	private static String getExpectedSourceHierarchyAA4h() {
+		String expected = "struct AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4h() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -10404,6 +10739,11 @@ private static String getSpeculatedStructAA4j() {
 		return convertCommentsToSpeculative(getExpectedStructAA4j());
 	}
 
+	private static String getExpectedSourceHierarchyAA4j() {
+		String expected = "struct AA4j : virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4j]");
@@ -10504,6 +10844,11 @@ private static String getSpeculatedStructAA4k() {
 		return convertCommentsToSpeculative(getExpectedStructAA4k());
 	}
 
+	private static String getExpectedSourceHierarchyAA4k() {
+		String expected = "struct AA4k : virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4k() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4k]");
@@ -10621,6 +10966,11 @@ private static String getSpeculatedStructAA4m() {
 		return convertCommentsToSpeculative(getExpectedStructAA4m());
 	}
 
+	private static String getExpectedSourceHierarchyAA4m() {
+		String expected = "struct AA4m : AA4j";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4m() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4m, AA4j]");
@@ -10738,6 +11088,11 @@ private static String getSpeculatedStructAA4n() {
 		return convertCommentsToSpeculative(getExpectedStructAA4n());
 	}
 
+	private static String getExpectedSourceHierarchyAA4n() {
+		String expected = "struct AA4n : AA4k, virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4n() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4n, AA4k]");
@@ -10872,6 +11227,11 @@ private static String getSpeculatedStructAA4p() {
 		return convertCommentsToSpeculative(getExpectedStructAA4p());
 	}
 
+	private static String getExpectedSourceHierarchyAA4p() {
+		String expected = "struct AA4p : AA4m, virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4p() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4p, AA4m, AA4j]");
@@ -11047,6 +11407,11 @@ private static String getSpeculatedStructAA4q() {
 		return convertCommentsToSpeculative(getExpectedStructAA4q());
 	}
 
+	private static String getExpectedSourceHierarchyAA4q() {
+		String expected = "struct AA4q : AA4n, AA4m";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4q() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -11125,6 +11490,11 @@ private static String getSpeculatedStructAA5a() {
 		return convertCommentsToSpeculative(getExpectedStructAA5a());
 	}
 
+	private static String getExpectedSourceHierarchyAA5a() {
+		String expected = "struct AA5a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11163,6 +11533,11 @@ private static String getSpeculatedStructAA5b() {
 		return convertCommentsToSpeculative(getExpectedStructAA5b());
 	}
 
+	private static String getExpectedSourceHierarchyAA5b() {
+		String expected = "struct AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11201,6 +11576,11 @@ private static String getSpeculatedStructAA5c() {
 		return convertCommentsToSpeculative(getExpectedStructAA5c());
 	}
 
+	private static String getExpectedSourceHierarchyAA5c() {
+		String expected = "struct AA5c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11239,6 +11619,11 @@ private static String getSpeculatedStructAA5d() {
 		return convertCommentsToSpeculative(getExpectedStructAA5d());
 	}
 
+	private static String getExpectedSourceHierarchyAA5d() {
+		String expected = "struct AA5d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11340,6 +11725,11 @@ private static String getSpeculatedStructAA5e() {
 		return convertCommentsToSpeculative(getExpectedStructAA5e());
 	}
 
+	private static String getExpectedSourceHierarchyAA5e() {
+		String expected = "struct AA5e : AA5a, virtual AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt []	[AA5e]");
@@ -11457,6 +11847,11 @@ private static String getSpeculatedStructAA5f() {
 		return convertCommentsToSpeculative(getExpectedStructAA5f());
 	}
 
+	private static String getExpectedSourceHierarchyAA5f() {
+		String expected = "struct AA5f : AA5c, virtual AA5d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt []	[AA5f]");
@@ -11602,6 +11997,11 @@ private static String getSpeculatedStructAA5g() {
 		return convertCommentsToSpeculative(getExpectedStructAA5g());
 	}
 
+	private static String getExpectedSourceHierarchyAA5g() {
+		String expected = "struct AA5g : AA5c, virtual AA5e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt [AA5g]	[AA5g]");
@@ -11768,6 +12168,11 @@ private static String getSpeculatedStructAA5h() {
 		return convertCommentsToSpeculative(getExpectedStructAA5h());
 	}
 
+	private static String getExpectedSourceHierarchyAA5h() {
+		String expected = "struct AA5h : AA5a, virtual AA5f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt [AA5h]	[AA5h]");
@@ -12021,6 +12426,11 @@ private static String getSpeculatedStructAA5j() {
 		return convertCommentsToSpeculative(getExpectedStructAA5j());
 	}
 
+	private static String getExpectedSourceHierarchyAA5j() {
+		String expected = "struct AA5j : AA5g, AA5h, virtual AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt [AA5g]	[AA5j, AA5g]");
@@ -12135,6 +12545,11 @@ private static String getSpeculatedStructAA6a() {
 		return convertCommentsToSpeculative(getExpectedStructAA6a());
 	}
 
+	private static String getExpectedSourceHierarchyAA6a() {
+		String expected = "struct AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12183,6 +12598,11 @@ private static String getSpeculatedStructAA6b() {
 		return convertCommentsToSpeculative(getExpectedStructAA6b());
 	}
 
+	private static String getExpectedSourceHierarchyAA6b() {
+		String expected = "struct AA6b : AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12267,6 +12687,11 @@ private static String getSpeculatedStructAA6c() {
 		return convertCommentsToSpeculative(getExpectedStructAA6c());
 	}
 
+	private static String getExpectedSourceHierarchyAA6c() {
+		String expected = "struct AA6c : virtual AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA6c]");
@@ -12329,6 +12754,11 @@ private static String getSpeculatedStructAA6d() {
 		return convertCommentsToSpeculative(getExpectedStructAA6d());
 	}
 
+	private static String getExpectedSourceHierarchyAA6d() {
+		String expected = "struct AA6d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12379,6 +12809,11 @@ private static String getSpeculatedStructAA6e() {
 		return convertCommentsToSpeculative(getExpectedStructAA6e());
 	}
 
+	private static String getExpectedSourceHierarchyAA6e() {
+		String expected = "struct AA6e : AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12439,6 +12874,11 @@ private static String getSpeculatedStructAA6f() {
 		return convertCommentsToSpeculative(getExpectedStructAA6f());
 	}
 
+	private static String getExpectedSourceHierarchyAA6f() {
+		String expected = "struct AA6f : AA6b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12549,6 +12989,11 @@ private static String getSpeculatedStructAA6g() {
 		return convertCommentsToSpeculative(getExpectedStructAA6g());
 	}
 
+	private static String getExpectedSourceHierarchyAA6g() {
+		String expected = "struct AA6g : AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA6g, AA6c]");
@@ -12676,6 +13121,11 @@ private static String getSpeculatedStructAA6h() {
 		return convertCommentsToSpeculative(getExpectedStructAA6h());
 	}
 
+	private static String getExpectedSourceHierarchyAA6h() {
+		String expected = "struct AA6h : virtual AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA6h]	[AA6h]");
@@ -12827,6 +13277,11 @@ private static String getSpeculatedStructAA6j() {
 		return convertCommentsToSpeculative(getExpectedStructAA6j());
 	}
 
+	private static String getExpectedSourceHierarchyAA6j() {
+		String expected = "struct AA6j : virtual AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA6j]	[AA6j]");
@@ -12913,6 +13368,11 @@ private static String getSpeculatedStructAA7a() {
 		return convertCommentsToSpeculative(getExpectedStructAA7a());
 	}
 
+	private static String getExpectedSourceHierarchyAA7a() {
+		String expected = "struct AA7a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[AA7a]");
@@ -12979,6 +13439,11 @@ private static String getSpeculatedStructAA7b() {
 		return convertCommentsToSpeculative(getExpectedStructAA7b());
 	}
 
+	private static String getExpectedSourceHierarchyAA7b() {
+		String expected = "struct AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[AA7b]");
@@ -13072,6 +13537,11 @@ private static String getSpeculatedStructAA7c() {
 		return convertCommentsToSpeculative(getExpectedStructAA7c());
 	}
 
+	private static String getExpectedSourceHierarchyAA7c() {
+		String expected = "struct AA7c : AA7a, AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [AA7a]	[AA7c, AA7a]");
@@ -13227,6 +13697,11 @@ private static String getSpeculatedStructAA7d() {
 		return convertCommentsToSpeculative(getExpectedStructAA7d());
 	}
 
+	private static String getExpectedSourceHierarchyAA7d() {
+		String expected = "struct AA7d : virtual AA7a, virtual AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [AA7d]	[AA7d]");
@@ -13332,6 +13807,11 @@ private static String getSpeculatedStructBB1a() {
 		return convertCommentsToSpeculative(getExpectedStructBB1a());
 	}
 
+	private static String getExpectedSourceHierarchyBB1a() {
+		String expected = "struct BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -13380,6 +13860,11 @@ private static String getSpeculatedStructBB1b() {
 		return convertCommentsToSpeculative(getExpectedStructBB1b());
 	}
 
+	private static String getExpectedSourceHierarchyBB1b() {
+		String expected = "struct BB1b : BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -13464,6 +13949,11 @@ private static String getSpeculatedStructBB1c() {
 		return convertCommentsToSpeculative(getExpectedStructBB1c());
 	}
 
+	private static String getExpectedSourceHierarchyBB1c() {
+		String expected = "struct BB1c : virtual BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB1c]");
@@ -13609,6 +14099,11 @@ private static String getSpeculatedStructBB1d() {
 		return convertCommentsToSpeculative(getExpectedStructBB1d());
 	}
 
+	private static String getExpectedSourceHierarchyBB1d() {
+		String expected = "struct BB1d : BB1b, BB1c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[BB1d, BB1c]");
@@ -13663,6 +14158,11 @@ private static String getSpeculatedStructBB2z() {
 		return convertCommentsToSpeculative(getExpectedStructBB2z());
 	}
 
+	private static String getExpectedSourceHierarchyBB2z() {
+		String expected = "struct BB2z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2z() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -13747,6 +14247,11 @@ private static String getSpeculatedStructBB2a() {
 		return convertCommentsToSpeculative(getExpectedStructBB2a());
 	}
 
+	private static String getExpectedSourceHierarchyBB2a() {
+		String expected = "struct BB2a : virtual BB2z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2a]");
@@ -13864,6 +14369,11 @@ private static String getSpeculatedStructBB2b() {
 		return convertCommentsToSpeculative(getExpectedStructBB2b());
 	}
 
+	private static String getExpectedSourceHierarchyBB2b() {
+		String expected = "struct BB2b : BB2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2b, BB2a]");
@@ -13982,6 +14492,11 @@ private static String getSpeculatedStructBB2c() {
 		return convertCommentsToSpeculative(getExpectedStructBB2c());
 	}
 
+	private static String getExpectedSourceHierarchyBB2c() {
+		String expected = "struct BB2c : virtual BB2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [BB2c]	[BB2c]");
@@ -14173,6 +14688,11 @@ private static String getSpeculatedStructBB2d() {
 		return convertCommentsToSpeculative(getExpectedStructBB2d());
 	}
 
+	private static String getExpectedSourceHierarchyBB2d() {
+		String expected = "struct BB2d : BB2b, BB2c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2d() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -14349,6 +14869,11 @@ private static String getSpeculatedStructBB2e() {
 		return convertCommentsToSpeculative(getExpectedStructBB2e());
 	}
 
+	private static String getExpectedSourceHierarchyBB2e() {
+		String expected = "struct BB2e : BB2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2e, BB2b, BB2a]");
@@ -14403,6 +14928,11 @@ private static String getSpeculatedStructBB3a() {
 		return convertCommentsToSpeculative(getExpectedStructBB3a());
 	}
 
+	private static String getExpectedSourceHierarchyBB3a() {
+		String expected = "struct BB3a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14441,6 +14971,11 @@ private static String getSpeculatedStructBB3b() {
 		return convertCommentsToSpeculative(getExpectedStructBB3b());
 	}
 
+	private static String getExpectedSourceHierarchyBB3b() {
+		String expected = "struct BB3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14479,6 +15014,11 @@ private static String getSpeculatedStructBB3c() {
 		return convertCommentsToSpeculative(getExpectedStructBB3c());
 	}
 
+	private static String getExpectedSourceHierarchyBB3c() {
+		String expected = "struct BB3c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14597,6 +15137,11 @@ private static String getSpeculatedStructBB3d() {
 		return convertCommentsToSpeculative(getExpectedStructBB3d());
 	}
 
+	private static String getExpectedSourceHierarchyBB3d() {
+		String expected = "struct BB3d : BB3a, BB3c, virtual BB3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[BB3d]");
@@ -14726,6 +15271,11 @@ private static String getSpeculatedStructBB3e() {
 		return convertCommentsToSpeculative(getExpectedStructBB3e());
 	}
 
+	private static String getExpectedSourceHierarchyBB3e() {
+		String expected = "struct BB3e : BB3b, virtual BB3a, virtual BB3c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt []	[BB3e]");
@@ -14926,6 +15476,11 @@ private static String getSpeculatedStructBB3f() {
 		return convertCommentsToSpeculative(getExpectedStructBB3f());
 	}
 
+	private static String getExpectedSourceHierarchyBB3f() {
+		String expected = "struct BB3f : BB3d, BB3e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [BB3d]	[BB3f, BB3d]");
@@ -15143,6 +15698,11 @@ private static String getSpeculatedStructBB3g() {
 		return convertCommentsToSpeculative(getExpectedStructBB3g());
 	}
 
+	private static String getExpectedSourceHierarchyBB3g() {
+		String expected = "struct BB3g : BB3e, BB3d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000004", "     4 vbt [BB3e]	[BB3g, BB3e]");
@@ -15215,6 +15775,11 @@ private static String getSpeculatedStructCC1a() {
 		return convertCommentsToSpeculative(getExpectedStructCC1a());
 	}
 
+	private static String getExpectedSourceHierarchyCC1a() {
+		String expected = "struct CC1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15253,6 +15818,11 @@ private static String getSpeculatedStructCC1b() {
 		return convertCommentsToSpeculative(getExpectedStructCC1b());
 	}
 
+	private static String getExpectedSourceHierarchyCC1b() {
+		String expected = "struct CC1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15291,6 +15861,11 @@ private static String getSpeculatedStructCC1c() {
 		return convertCommentsToSpeculative(getExpectedStructCC1c());
 	}
 
+	private static String getExpectedSourceHierarchyCC1c() {
+		String expected = "struct CC1c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15329,6 +15904,11 @@ private static String getSpeculatedStructCC1d() {
 		return convertCommentsToSpeculative(getExpectedStructCC1d());
 	}
 
+	private static String getExpectedSourceHierarchyCC1d() {
+		String expected = "struct CC1d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15367,6 +15947,11 @@ private static String getSpeculatedStructCC1e() {
 		return convertCommentsToSpeculative(getExpectedStructCC1e());
 	}
 
+	private static String getExpectedSourceHierarchyCC1e() {
+		String expected = "struct CC1e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15405,6 +15990,11 @@ private static String getSpeculatedStructCC1f() {
 		return convertCommentsToSpeculative(getExpectedStructCC1f());
 	}
 
+	private static String getExpectedSourceHierarchyCC1f() {
+		String expected = "struct CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15504,6 +16094,11 @@ private static String getSpeculatedStructCC1g() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g() {
+		String expected = "struct CC1g : CC1a, CC1b, CC1c, CC1d, CC1e, CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15710,6 +16305,12 @@ private static String getSpeculatedStructCC1h() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyCC1h() {
+		String expected =
+			"struct CC1h : virtual CC1a, virtual CC1b, virtual CC1c, virtual CC1d, virtual CC1e, virtual CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[CC1h]");
@@ -15784,6 +16385,11 @@ private static String getSpeculatedStructCC1g_counterpoint() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g_counterpoint());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g_counterpoint() {
+		String expected = "struct CC1g_counterpoint";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g_counterpoint() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15837,6 +16443,11 @@ private static String getSpeculatedStructCC1h_counterpoint() {
 		return convertCommentsToSpeculative(getExpectedStructCC1h_counterpoint());
 	}
 
+	private static String getExpectedSourceHierarchyCC1h_counterpoint() {
+		String expected = "struct CC1h_counterpoint";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h_counterpoint() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15890,6 +16501,11 @@ private static String getSpeculatedStructCC1g_counterpoint2() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g_counterpoint2());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g_counterpoint2() {
+		String expected = "struct CC1g_counterpoint2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g_counterpoint2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15943,6 +16559,11 @@ private static String getSpeculatedStructCC1h_counterpoint2() {
 		return convertCommentsToSpeculative(getExpectedStructCC1h_counterpoint2());
 	}
 
+	private static String getExpectedSourceHierarchyCC1h_counterpoint2() {
+		String expected = "struct CC1h_counterpoint2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h_counterpoint2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15983,6 +16604,11 @@ private static String getSpeculatedStructCC2a() {
 		return convertCommentsToSpeculative(getExpectedStructCC2a());
 	}
 
+	private static String getExpectedSourceHierarchyCC2a() {
+		String expected = "struct CC2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16024,6 +16650,11 @@ private static String getSpeculatedStructCC2b() {
 		return convertCommentsToSpeculative(getExpectedStructCC2b());
 	}
 
+	private static String getExpectedSourceHierarchyCC2b() {
+		String expected = "struct CC2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16065,6 +16696,11 @@ private static String getSpeculatedStructCC2c() {
 		return convertCommentsToSpeculative(getExpectedStructCC2c());
 	}
 
+	private static String getExpectedSourceHierarchyCC2c() {
+		String expected = "struct CC2c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16106,6 +16742,11 @@ private static String getSpeculatedStructCC2d() {
 		return convertCommentsToSpeculative(getExpectedStructCC2d());
 	}
 
+	private static String getExpectedSourceHierarchyCC2d() {
+		String expected = "struct CC2d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16147,6 +16788,11 @@ private static String getSpeculatedStructCC2e() {
 		return convertCommentsToSpeculative(getExpectedStructCC2e());
 	}
 
+	private static String getExpectedSourceHierarchyCC2e() {
+		String expected = "struct CC2e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16188,6 +16834,11 @@ private static String getSpeculatedStructCC2f() {
 		return convertCommentsToSpeculative(getExpectedStructCC2f());
 	}
 
+	private static String getExpectedSourceHierarchyCC2f() {
+		String expected = "struct CC2f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16229,6 +16880,11 @@ private static String getSpeculatedStructCC2g() {
 		return convertCommentsToSpeculative(getExpectedStructCC2g());
 	}
 
+	private static String getExpectedSourceHierarchyCC2g() {
+		String expected = "struct CC2g";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2g() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16270,6 +16926,11 @@ private static String getSpeculatedStructCC2h() {
 		return convertCommentsToSpeculative(getExpectedStructCC2h());
 	}
 
+	private static String getExpectedSourceHierarchyCC2h() {
+		String expected = "struct CC2h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2h() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16311,6 +16972,11 @@ private static String getSpeculatedStructCC2j() {
 		return convertCommentsToSpeculative(getExpectedStructCC2j());
 	}
 
+	private static String getExpectedSourceHierarchyCC2j() {
+		String expected = "struct CC2j";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2j() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16349,6 +17015,11 @@ private static String getSpeculatedStructDD1a() {
 		return convertCommentsToSpeculative(getExpectedStructDD1a());
 	}
 
+	private static String getExpectedSourceHierarchyDD1a() {
+		String expected = "struct DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16433,6 +17104,11 @@ private static String getSpeculatedStructDD1b() {
 		return convertCommentsToSpeculative(getExpectedStructDD1b());
 	}
 
+	private static String getExpectedSourceHierarchyDD1b() {
+		String expected = "struct DD1b : virtual DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1b]");
@@ -16550,6 +17226,11 @@ private static String getSpeculatedStructDD1c() {
 		return convertCommentsToSpeculative(getExpectedStructDD1c());
 	}
 
+	private static String getExpectedSourceHierarchyDD1c() {
+		String expected = "struct DD1c : DD1b, virtual DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1c, DD1b]");
@@ -16667,6 +17348,11 @@ private static String getSpeculatedStructDD1d() {
 		return convertCommentsToSpeculative(getExpectedStructDD1d());
 	}
 
+	private static String getExpectedSourceHierarchyDD1d() {
+		String expected = "struct DD1d : DD1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1d, DD1b]");
@@ -16721,6 +17407,11 @@ private static String getSpeculatedStructDD2a() {
 		return convertCommentsToSpeculative(getExpectedStructDD2a());
 	}
 
+	private static String getExpectedSourceHierarchyDD2a() {
+		String expected = "struct DD2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16759,6 +17450,11 @@ private static String getSpeculatedStructDD2b() {
 		return convertCommentsToSpeculative(getExpectedStructDD2b());
 	}
 
+	private static String getExpectedSourceHierarchyDD2b() {
+		String expected = "struct DD2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16807,6 +17503,11 @@ private static String getSpeculatedStructDD2c() {
 		return convertCommentsToSpeculative(getExpectedStructDD2c());
 	}
 
+	private static String getExpectedSourceHierarchyDD2c() {
+		String expected = "struct DD2c : DD2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16865,6 +17566,11 @@ private static String getSpeculatedStructDD2d() {
 		return convertCommentsToSpeculative(getExpectedStructDD2d());
 	}
 
+	private static String getExpectedSourceHierarchyDD2d() {
+		String expected = "struct DD2d : DD2a, DD2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16947,6 +17653,11 @@ private static String getSpeculatedStructDD2e() {
 		return convertCommentsToSpeculative(getExpectedStructDD2e());
 	}
 
+	private static String getExpectedSourceHierarchyDD2e() {
+		String expected = "struct DD2e : DD2c, DD2d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17329,6 +18040,163 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedStructs.put(DD2e, getSpeculatedStructDD2e());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(A, getExpectedSourceHierarchyA());
+		expectedSourceHierarchy.put(B, getExpectedSourceHierarchyB());
+		expectedSourceHierarchy.put(C, getExpectedSourceHierarchyC());
+		expectedSourceHierarchy.put(CC1, getExpectedSourceHierarchyCC1());
+		expectedSourceHierarchy.put(CC2, getExpectedSourceHierarchyCC2());
+		expectedSourceHierarchy.put(CC3, getExpectedSourceHierarchyCC3());
+		expectedSourceHierarchy.put(D, getExpectedSourceHierarchyD());
+		expectedSourceHierarchy.put(E, getExpectedSourceHierarchyE());
+		expectedSourceHierarchy.put(F, getExpectedSourceHierarchyF());
+		expectedSourceHierarchy.put(G, getExpectedSourceHierarchyG());
+		expectedSourceHierarchy.put(H, getExpectedSourceHierarchyH());
+		expectedSourceHierarchy.put(GG1, getExpectedSourceHierarchyGG1());
+		expectedSourceHierarchy.put(GG2, getExpectedSourceHierarchyGG2());
+		expectedSourceHierarchy.put(GG3, getExpectedSourceHierarchyGG3());
+		expectedSourceHierarchy.put(GG4, getExpectedSourceHierarchyGG4());
+		expectedSourceHierarchy.put(I, getExpectedSourceHierarchyI());
+		expectedSourceHierarchy.put(GX1, getExpectedSourceHierarchyGX1());
+		expectedSourceHierarchy.put(HX1, getExpectedSourceHierarchyHX1());
+		expectedSourceHierarchy.put(IX1, getExpectedSourceHierarchyIX1());
+		expectedSourceHierarchy.put(G1, getExpectedSourceHierarchyG1());
+		expectedSourceHierarchy.put(H1, getExpectedSourceHierarchyH1());
+		expectedSourceHierarchy.put(I1, getExpectedSourceHierarchyI1());
+		expectedSourceHierarchy.put(I2, getExpectedSourceHierarchyI2());
+		expectedSourceHierarchy.put(I3, getExpectedSourceHierarchyI3());
+		expectedSourceHierarchy.put(I4, getExpectedSourceHierarchyI4());
+		expectedSourceHierarchy.put(I5, getExpectedSourceHierarchyI5());
+		expectedSourceHierarchy.put(J1, getExpectedSourceHierarchyJ1());
+		expectedSourceHierarchy.put(J2, getExpectedSourceHierarchyJ2());
+		expectedSourceHierarchy.put(J3, getExpectedSourceHierarchyJ3());
+		expectedSourceHierarchy.put(J4, getExpectedSourceHierarchyJ4());
+		expectedSourceHierarchy.put(J5, getExpectedSourceHierarchyJ5());
+		expectedSourceHierarchy.put(J6, getExpectedSourceHierarchyJ6());
+		expectedSourceHierarchy.put(P, getExpectedSourceHierarchyP());
+		expectedSourceHierarchy.put(Q, getExpectedSourceHierarchyQ());
+		expectedSourceHierarchy.put(R, getExpectedSourceHierarchyR());
+		expectedSourceHierarchy.put(S, getExpectedSourceHierarchyS());
+		expectedSourceHierarchy.put(T, getExpectedSourceHierarchyT());
+		expectedSourceHierarchy.put(U, getExpectedSourceHierarchyU());
+		expectedSourceHierarchy.put(V, getExpectedSourceHierarchyV());
+		expectedSourceHierarchy.put(W, getExpectedSourceHierarchyW());
+		expectedSourceHierarchy.put(WW, getExpectedSourceHierarchyWW());
+		expectedSourceHierarchy.put(X, getExpectedSourceHierarchyX());
+		expectedSourceHierarchy.put(Z, getExpectedSourceHierarchyZ());
+		expectedSourceHierarchy.put(AA1a, getExpectedSourceHierarchyAA1a());
+		expectedSourceHierarchy.put(AA1b, getExpectedSourceHierarchyAA1b());
+		expectedSourceHierarchy.put(AA1, getExpectedSourceHierarchyAA1());
+		expectedSourceHierarchy.put(AA2a, getExpectedSourceHierarchyAA2a());
+		expectedSourceHierarchy.put(AA2b, getExpectedSourceHierarchyAA2b());
+		expectedSourceHierarchy.put(AA2, getExpectedSourceHierarchyAA2());
+		expectedSourceHierarchy.put(AA3a, getExpectedSourceHierarchyAA3a());
+		expectedSourceHierarchy.put(AA3b, getExpectedSourceHierarchyAA3b());
+		expectedSourceHierarchy.put(AA3c, getExpectedSourceHierarchyAA3c());
+		expectedSourceHierarchy.put(AA3d, getExpectedSourceHierarchyAA3d());
+		expectedSourceHierarchy.put(AA3e, getExpectedSourceHierarchyAA3e());
+		expectedSourceHierarchy.put(AA3f, getExpectedSourceHierarchyAA3f());
+		expectedSourceHierarchy.put(AA3g, getExpectedSourceHierarchyAA3g());
+		expectedSourceHierarchy.put(AA4a, getExpectedSourceHierarchyAA4a());
+		expectedSourceHierarchy.put(AA4b, getExpectedSourceHierarchyAA4b());
+		expectedSourceHierarchy.put(AA4c, getExpectedSourceHierarchyAA4c());
+		expectedSourceHierarchy.put(AA4d, getExpectedSourceHierarchyAA4d());
+		expectedSourceHierarchy.put(AA4e, getExpectedSourceHierarchyAA4e());
+		expectedSourceHierarchy.put(AA4f, getExpectedSourceHierarchyAA4f());
+		expectedSourceHierarchy.put(AA4g, getExpectedSourceHierarchyAA4g());
+		expectedSourceHierarchy.put(AA4h, getExpectedSourceHierarchyAA4h());
+		expectedSourceHierarchy.put(AA4j, getExpectedSourceHierarchyAA4j());
+		expectedSourceHierarchy.put(AA4k, getExpectedSourceHierarchyAA4k());
+		expectedSourceHierarchy.put(AA4m, getExpectedSourceHierarchyAA4m());
+		expectedSourceHierarchy.put(AA4n, getExpectedSourceHierarchyAA4n());
+		expectedSourceHierarchy.put(AA4p, getExpectedSourceHierarchyAA4p());
+		expectedSourceHierarchy.put(AA4q, getExpectedSourceHierarchyAA4q());
+		expectedSourceHierarchy.put(AA5a, getExpectedSourceHierarchyAA5a());
+		expectedSourceHierarchy.put(AA5b, getExpectedSourceHierarchyAA5b());
+		expectedSourceHierarchy.put(AA5c, getExpectedSourceHierarchyAA5c());
+		expectedSourceHierarchy.put(AA5d, getExpectedSourceHierarchyAA5d());
+		expectedSourceHierarchy.put(AA5e, getExpectedSourceHierarchyAA5e());
+		expectedSourceHierarchy.put(AA5f, getExpectedSourceHierarchyAA5f());
+		expectedSourceHierarchy.put(AA5g, getExpectedSourceHierarchyAA5g());
+		expectedSourceHierarchy.put(AA5h, getExpectedSourceHierarchyAA5h());
+		expectedSourceHierarchy.put(AA5j, getExpectedSourceHierarchyAA5j());
+		expectedSourceHierarchy.put(AA6a, getExpectedSourceHierarchyAA6a());
+		expectedSourceHierarchy.put(AA6b, getExpectedSourceHierarchyAA6b());
+		expectedSourceHierarchy.put(AA6c, getExpectedSourceHierarchyAA6c());
+		expectedSourceHierarchy.put(AA6d, getExpectedSourceHierarchyAA6d());
+		expectedSourceHierarchy.put(AA6e, getExpectedSourceHierarchyAA6e());
+		expectedSourceHierarchy.put(AA6f, getExpectedSourceHierarchyAA6f());
+		expectedSourceHierarchy.put(AA6g, getExpectedSourceHierarchyAA6g());
+		expectedSourceHierarchy.put(AA6h, getExpectedSourceHierarchyAA6h());
+		expectedSourceHierarchy.put(AA6j, getExpectedSourceHierarchyAA6j());
+		expectedSourceHierarchy.put(AA7a, getExpectedSourceHierarchyAA7a());
+		expectedSourceHierarchy.put(AA7b, getExpectedSourceHierarchyAA7b());
+		expectedSourceHierarchy.put(AA7c, getExpectedSourceHierarchyAA7c());
+		expectedSourceHierarchy.put(AA7d, getExpectedSourceHierarchyAA7d());
+		expectedSourceHierarchy.put(BB1a, getExpectedSourceHierarchyBB1a());
+		expectedSourceHierarchy.put(BB1b, getExpectedSourceHierarchyBB1b());
+		expectedSourceHierarchy.put(BB1c, getExpectedSourceHierarchyBB1c());
+		expectedSourceHierarchy.put(BB1d, getExpectedSourceHierarchyBB1d());
+		expectedSourceHierarchy.put(BB2z, getExpectedSourceHierarchyBB2z());
+		expectedSourceHierarchy.put(BB2a, getExpectedSourceHierarchyBB2a());
+		expectedSourceHierarchy.put(BB2b, getExpectedSourceHierarchyBB2b());
+		expectedSourceHierarchy.put(BB2c, getExpectedSourceHierarchyBB2c());
+		expectedSourceHierarchy.put(BB2d, getExpectedSourceHierarchyBB2d());
+		expectedSourceHierarchy.put(BB2e, getExpectedSourceHierarchyBB2e());
+		expectedSourceHierarchy.put(BB3a, getExpectedSourceHierarchyBB3a());
+		expectedSourceHierarchy.put(BB3b, getExpectedSourceHierarchyBB3b());
+		expectedSourceHierarchy.put(BB3c, getExpectedSourceHierarchyBB3c());
+		expectedSourceHierarchy.put(BB3d, getExpectedSourceHierarchyBB3d());
+		expectedSourceHierarchy.put(BB3e, getExpectedSourceHierarchyBB3e());
+		expectedSourceHierarchy.put(BB3f, getExpectedSourceHierarchyBB3f());
+		expectedSourceHierarchy.put(BB3g, getExpectedSourceHierarchyBB3g());
+		expectedSourceHierarchy.put(CC1a, getExpectedSourceHierarchyCC1a());
+		expectedSourceHierarchy.put(CC1b, getExpectedSourceHierarchyCC1b());
+		expectedSourceHierarchy.put(CC1c, getExpectedSourceHierarchyCC1c());
+		expectedSourceHierarchy.put(CC1d, getExpectedSourceHierarchyCC1d());
+		expectedSourceHierarchy.put(CC1e, getExpectedSourceHierarchyCC1e());
+		expectedSourceHierarchy.put(CC1f, getExpectedSourceHierarchyCC1f());
+		expectedSourceHierarchy.put(CC1g, getExpectedSourceHierarchyCC1g());
+		expectedSourceHierarchy.put(CC1h, getExpectedSourceHierarchyCC1h());
+		expectedSourceHierarchy.put(CC1g_counterpoint,
+			getExpectedSourceHierarchyCC1g_counterpoint());
+		expectedSourceHierarchy.put(CC1h_counterpoint,
+			getExpectedSourceHierarchyCC1h_counterpoint());
+		expectedSourceHierarchy.put(CC1g_counterpoint2,
+			getExpectedSourceHierarchyCC1g_counterpoint2());
+		expectedSourceHierarchy.put(CC1h_counterpoint2,
+			getExpectedSourceHierarchyCC1h_counterpoint2());
+		expectedSourceHierarchy.put(CC2a, getExpectedSourceHierarchyCC2a());
+		expectedSourceHierarchy.put(CC2b, getExpectedSourceHierarchyCC2b());
+		expectedSourceHierarchy.put(CC2c, getExpectedSourceHierarchyCC2c());
+		expectedSourceHierarchy.put(CC2d, getExpectedSourceHierarchyCC2d());
+		expectedSourceHierarchy.put(CC2e, getExpectedSourceHierarchyCC2e());
+		expectedSourceHierarchy.put(CC2f, getExpectedSourceHierarchyCC2f());
+		expectedSourceHierarchy.put(CC2g, getExpectedSourceHierarchyCC2g());
+		expectedSourceHierarchy.put(CC2h, getExpectedSourceHierarchyCC2h());
+		expectedSourceHierarchy.put(CC2j, getExpectedSourceHierarchyCC2j());
+		expectedSourceHierarchy.put(DD1a, getExpectedSourceHierarchyDD1a());
+		expectedSourceHierarchy.put(DD1b, getExpectedSourceHierarchyDD1b());
+		expectedSourceHierarchy.put(DD1c, getExpectedSourceHierarchyDD1c());
+		expectedSourceHierarchy.put(DD1d, getExpectedSourceHierarchyDD1d());
+		expectedSourceHierarchy.put(DD2a, getExpectedSourceHierarchyDD2a());
+		expectedSourceHierarchy.put(DD2b, getExpectedSourceHierarchyDD2b());
+		expectedSourceHierarchy.put(DD2c, getExpectedSourceHierarchyDD2c());
+		expectedSourceHierarchy.put(DD2d, getExpectedSourceHierarchyDD2d());
+		expectedSourceHierarchy.put(DD2e, getExpectedSourceHierarchyDD2e());
+	}
+
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+		// The following will replace entries as needed
+		speculatedSourceHierarchy.put(I5, getSpeculatedSourceHierarchyI5());
+		speculatedSourceHierarchy.put(J5, getSpeculatedSourceHierarchyJ5());
+		speculatedSourceHierarchy.put(AA3c, getSpeculatedSourceHierarchyAA3c());
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new LinkedHashMap<>();
 	static {
@@ -17481,7 +18349,6 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedVxtPtrSummaries.putAll(expectedVxtPtrSummaries);
 		// The following will replace entries as needed
 		speculatedVxtPtrSummaries.put(J5, getSpeculatedVxtPtrSummaryJ5());
-		speculatedVxtPtrSummaries.put(J6, getSpeculatedVxtPtrSummaryJ6());
 		// Need to implement values for classes P through DD2e
 	}
 
@@ -17635,7 +18502,6 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedVxtStructs.putAll(expectedVxtStructs);
 		// The following will replace entries as needed
 		speculatedVxtStructs.put(J5, getSpeculatedVxtStructsJ5());
-		speculatedVxtStructs.put(J6, getSpeculatedVxtStructsJ6());
 		// Need to implement values for classes P through DD2e
 
 		speculatedVxtStructs.put(T, getSpeculatedVxtStructsT());
@@ -17808,6 +18674,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray864ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray864ProgramCreator.java
index 23f43d29ea6..1ef19644ddc 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray864ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Egray864ProgramCreator.java
@@ -2045,6 +2045,11 @@ private static String getSpeculatedStructA() {
 		return convertCommentsToSpeculative(getExpectedStructA());
 	}
 
+	private static String getExpectedSourceHierarchyA() {
+		String expected = "struct A";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryA() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2101,6 +2106,11 @@ private static String getSpeculatedStructB() {
 		return convertCommentsToSpeculative(getExpectedStructB());
 	}
 
+	private static String getExpectedSourceHierarchyB() {
+		String expected = "struct B";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryB() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2145,6 +2155,11 @@ private static String getSpeculatedStructC() {
 		return convertCommentsToSpeculative(getExpectedStructC());
 	}
 
+	private static String getExpectedSourceHierarchyC() {
+		String expected = "struct C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryC() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2188,6 +2203,11 @@ private static String getSpeculatedStructCC1() {
 		return convertCommentsToSpeculative(getExpectedStructCC1());
 	}
 
+	private static String getExpectedSourceHierarchyCC1() {
+		String expected = "struct CC1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2231,6 +2251,11 @@ private static String getSpeculatedStructCC2() {
 		return convertCommentsToSpeculative(getExpectedStructCC2());
 	}
 
+	private static String getExpectedSourceHierarchyCC2() {
+		String expected = "struct CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2271,6 +2296,11 @@ private static String getSpeculatedStructCC3() {
 		return convertCommentsToSpeculative(getExpectedStructCC3());
 	}
 
+	private static String getExpectedSourceHierarchyCC3() {
+		String expected = "struct CC3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC3() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2324,6 +2354,11 @@ private static String getSpeculatedStructD() {
 		return convertCommentsToSpeculative(getExpectedStructD());
 	}
 
+	private static String getExpectedSourceHierarchyD() {
+		String expected = "struct D : C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryD() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2367,6 +2402,11 @@ private static String getSpeculatedStructE() {
 		return convertCommentsToSpeculative(getExpectedStructE());
 	}
 
+	private static String getExpectedSourceHierarchyE() {
+		String expected = "struct E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryE() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2430,6 +2470,11 @@ private static String getSpeculatedStructF() {
 		return convertCommentsToSpeculative(getExpectedStructF());
 	}
 
+	private static String getExpectedSourceHierarchyF() {
+		String expected = "struct F : C, E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryF() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -2520,6 +2565,11 @@ private static String getSpeculatedStructG() {
 		return convertCommentsToSpeculative(getExpectedStructG());
 	}
 
+	private static String getExpectedSourceHierarchyG() {
+		String expected = "struct G : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[G]");
@@ -2626,6 +2676,11 @@ private static String getSpeculatedStructH() {
 		return convertCommentsToSpeculative(getExpectedStructH());
 	}
 
+	private static String getExpectedSourceHierarchyH() {
+		String expected = "struct H : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[H]");
@@ -2732,6 +2787,11 @@ private static String getSpeculatedStructGG1() {
 		return convertCommentsToSpeculative(getExpectedStructGG1());
 	}
 
+	private static String getExpectedSourceHierarchyGG1() {
+		String expected = "struct GG1 : virtual CC1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG1]");
@@ -2838,6 +2898,11 @@ private static String getSpeculatedStructGG2() {
 		return convertCommentsToSpeculative(getExpectedStructGG2());
 	}
 
+	private static String getExpectedSourceHierarchyGG2() {
+		String expected = "struct GG2 : virtual CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG2]");
@@ -2944,6 +3009,11 @@ private static String getSpeculatedStructGG3() {
 		return convertCommentsToSpeculative(getExpectedStructGG3());
 	}
 
+	private static String getExpectedSourceHierarchyGG3() {
+		String expected = "struct GG3 : virtual CC2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG3]");
@@ -3046,6 +3116,11 @@ private static String getSpeculatedStructGG4() {
 		return convertCommentsToSpeculative(getExpectedStructGG4());
 	}
 
+	private static String getExpectedSourceHierarchyGG4() {
+		String expected = "struct GG4 : virtual CC3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGG4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GG4]");
@@ -3197,6 +3272,11 @@ private static String getSpeculatedStructI() {
 		return convertCommentsToSpeculative(getExpectedStructI());
 	}
 
+	private static String getExpectedSourceHierarchyI() {
+		String expected = "struct I : G, H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[I, G]");
@@ -3315,6 +3395,11 @@ private static String getSpeculatedStructGX1() {
 		return convertCommentsToSpeculative(getExpectedStructGX1());
 	}
 
+	private static String getExpectedSourceHierarchyGX1() {
+		String expected = "struct GX1 : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryGX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[GX1]");
@@ -3419,6 +3504,11 @@ private static String getSpeculatedStructHX1() {
 		return convertCommentsToSpeculative(getExpectedStructHX1());
 	}
 
+	private static String getExpectedSourceHierarchyHX1() {
+		String expected = "struct HX1 : virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryHX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[HX1]");
@@ -3563,6 +3653,11 @@ private static String getSpeculatedStructIX1() {
 		return convertCommentsToSpeculative(getExpectedStructIX1());
 	}
 
+	private static String getExpectedSourceHierarchyIX1() {
+		String expected = "struct IX1 : GX1, HX1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryIX1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [GX1]	[IX1, GX1]");
@@ -3697,6 +3792,11 @@ private static String getSpeculatedStructG1() {
 		return convertCommentsToSpeculative(getExpectedStructG1());
 	}
 
+	private static String getExpectedSourceHierarchyG1() {
+		String expected = "struct G1 : virtual C, virtual E";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryG1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[G1]");
@@ -3816,6 +3916,11 @@ private static String getSpeculatedStructH1() {
 		return convertCommentsToSpeculative(getExpectedStructH1());
 	}
 
+	private static String getExpectedSourceHierarchyH1() {
+		String expected = "struct H1 : virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryH1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[H1]");
@@ -3979,6 +4084,11 @@ private static String getSpeculatedStructI1() {
 		return convertCommentsToSpeculative(getExpectedStructI1());
 	}
 
+	private static String getExpectedSourceHierarchyI1() {
+		String expected = "struct I1 : G1, H";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[I1, G1]");
@@ -4159,6 +4269,11 @@ private static String getSpeculatedStructI2() {
 		return convertCommentsToSpeculative(getExpectedStructI2());
 	}
 
+	private static String getExpectedSourceHierarchyI2() {
+		String expected = "struct I2 : G, H1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[I2, G]");
@@ -4339,6 +4454,11 @@ private static String getSpeculatedStructI3() {
 		return convertCommentsToSpeculative(getExpectedStructI3());
 	}
 
+	private static String getExpectedSourceHierarchyI3() {
+		String expected = "struct I3 : G1, H1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[I3, G1]");
@@ -4492,6 +4612,11 @@ private static String getSpeculatedStructI4() {
 		return convertCommentsToSpeculative(getExpectedStructI4());
 	}
 
+	private static String getExpectedSourceHierarchyI4() {
+		String expected = "struct I4 : G1, virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[I4, G1]");
@@ -4679,6 +4804,16 @@ private static String getSpeculatedStructI5() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyI5() {
+		String expected = "struct I5 : virtual E, G1, virtual C";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyI5() {
+		String expected = "struct I5 : G1, virtual E, virtual C";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryI5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[I5, G1]");
@@ -4931,6 +5066,11 @@ private static String getSpeculatedStructJ1() {
 		return convertCommentsToSpeculative(getExpectedStructJ1());
 	}
 
+	private static String getExpectedSourceHierarchyJ1() {
+		String expected = "struct J1 : I1, I2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J1, I1, G1]");
@@ -5233,6 +5373,11 @@ private static String getSpeculatedStructJ2() {
 		return convertCommentsToSpeculative(getExpectedStructJ2());
 	}
 
+	private static String getExpectedSourceHierarchyJ2() {
+		String expected = "struct J2 : I2, I1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[J2, I2, G]");
@@ -5556,6 +5701,11 @@ private static String getSpeculatedStructJ3() {
 		return convertCommentsToSpeculative(getExpectedStructJ3());
 	}
 
+	private static String getExpectedSourceHierarchyJ3() {
+		String expected = "struct J3 : I2, I1, A";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G]	[J3, I2, G]");
@@ -5969,6 +6119,11 @@ private static String getSpeculatedStructJ4() {
 		return convertCommentsToSpeculative(getExpectedStructJ4());
 	}
 
+	private static String getExpectedSourceHierarchyJ4() {
+		String expected = "struct J4 : I3, GG1, I, A, virtual GG2, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J4, I3, G1]");
@@ -6476,6 +6631,16 @@ private static String getSpeculatedStructJ5() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyJ5() {
+		String expected = "struct J5 : virtual GG2, virtual GG3, I3, GG1, I, A";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyJ5() {
+		String expected = "struct J5 : I3, GG1, I, A, virtual GG2, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [G1]	[J5, I3, G1]");
@@ -6723,8 +6888,8 @@ private static String getExpectedStructJ6() {
 			pack()
 			Structure J6 {
 			   0   J6   24      "Self Base"
-			   24   GG4   16      "Virtual Base"
-			   40   CC2   4      "Virtual Base and previous (Empty Virtual Base CC3)"
+			   24   GG4   16      "Virtual Base and previous (Empty Virtual Base CC3)"
+			   40   CC2   4      "Virtual Base"
 			   48   GG3   16      "Virtual Base"
 			}
 			Length: 64 Alignment: 8
@@ -6807,8 +6972,8 @@ private static String getSpeculatedStructJ6() {
 			pack()
 			Structure J6 {
 			   0   J6   24      "Self Base"
-			   24   CC2   4      "Virtual Base - Speculative Placement and previous (Empty Virtual Base CC3)"
-			   32   GG4   16      "Virtual Base - Speculative Placement"
+			   24   GG4   16      "Virtual Base - Speculative Placement and previous (Empty Virtual Base CC3)"
+			   40   CC2   4      "Virtual Base - Speculative Placement"
 			   48   GG3   16      "Virtual Base - Speculative Placement"
 			}
 			Length: 64 Alignment: 8
@@ -6851,6 +7016,11 @@ private static String getSpeculatedStructJ6() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyJ6() {
+		String expected = "struct J6 : A, virtual GG4, virtual GG3";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryJ6() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [J6]	[J6]");
@@ -6993,6 +7163,11 @@ private static String getSpeculatedStructP() {
 		return convertCommentsToSpeculative(getExpectedStructP());
 	}
 
+	private static String getExpectedSourceHierarchyP() {
+		String expected = "struct P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P]");
@@ -7070,6 +7245,11 @@ private static String getSpeculatedStructQ() {
 		return convertCommentsToSpeculative(getExpectedStructQ());
 	}
 
+	private static String getExpectedSourceHierarchyQ() {
+		String expected = "struct Q : P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[Q, P]");
@@ -7137,6 +7317,11 @@ private static String getSpeculatedStructR() {
 		return convertCommentsToSpeculative(getExpectedStructR());
 	}
 
+	private static String getExpectedSourceHierarchyR() {
+		String expected = "struct R";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryR() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[R]");
@@ -7234,6 +7419,11 @@ private static String getSpeculatedStructS() {
 		return convertCommentsToSpeculative(getExpectedStructS());
 	}
 
+	private static String getExpectedSourceHierarchyS() {
+		String expected = "struct S : P, R";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryS() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P]	[S, P]");
@@ -7399,6 +7589,11 @@ private static String getSpeculatedStructT() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyT() {
+		String expected = "struct T : virtual P";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryT() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [T]	[T]");
@@ -7628,6 +7823,11 @@ private static String getSpeculatedStructU() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyU() {
+		String expected = "struct U : T";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryU() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [T]	[U, T]");
@@ -7749,6 +7949,11 @@ private static String getSpeculatedStructV() {
 		return convertCommentsToSpeculative(getExpectedStructV());
 	}
 
+	private static String getExpectedSourceHierarchyV() {
+		String expected = "struct V";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryV() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[V]");
@@ -7820,6 +8025,11 @@ private static String getSpeculatedStructW() {
 		return convertCommentsToSpeculative(getExpectedStructW());
 	}
 
+	private static String getExpectedSourceHierarchyW() {
+		String expected = "struct W : V";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryW() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[W, V]");
@@ -7902,6 +8112,11 @@ private static String getSpeculatedStructWW() {
 		return convertCommentsToSpeculative(getExpectedStructWW());
 	}
 
+	private static String getExpectedSourceHierarchyWW() {
+		String expected = "struct WW : W";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryWW() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[WW, W, V]");
@@ -7954,6 +8169,11 @@ private static String getSpeculatedStructX() {
 		return convertCommentsToSpeculative(getExpectedStructX());
 	}
 
+	private static String getExpectedSourceHierarchyX() {
+		String expected = "struct X";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryX() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -7990,6 +8210,11 @@ private static String getSpeculatedStructZ() {
 		return convertCommentsToSpeculative(getExpectedStructZ());
 	}
 
+	private static String getExpectedSourceHierarchyZ() {
+		String expected = "struct Z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryZ() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8028,6 +8253,11 @@ private static String getSpeculatedStructAA1a() {
 		return convertCommentsToSpeculative(getExpectedStructAA1a());
 	}
 
+	private static String getExpectedSourceHierarchyAA1a() {
+		String expected = "struct AA1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8066,6 +8296,11 @@ private static String getSpeculatedStructAA1b() {
 		return convertCommentsToSpeculative(getExpectedStructAA1b());
 	}
 
+	private static String getExpectedSourceHierarchyAA1b() {
+		String expected = "struct AA1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8124,6 +8359,11 @@ private static String getSpeculatedStructAA1() {
 		return convertCommentsToSpeculative(getExpectedStructAA1());
 	}
 
+	private static String getExpectedSourceHierarchyAA1() {
+		String expected = "struct AA1 : AA1a, AA1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA1() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8162,6 +8402,11 @@ private static String getSpeculatedStructAA2a() {
 		return convertCommentsToSpeculative(getExpectedStructAA2a());
 	}
 
+	private static String getExpectedSourceHierarchyAA2a() {
+		String expected = "struct AA2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8200,6 +8445,11 @@ private static String getSpeculatedStructAA2b() {
 		return convertCommentsToSpeculative(getExpectedStructAA2b());
 	}
 
+	private static String getExpectedSourceHierarchyAA2b() {
+		String expected = "struct AA2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8258,6 +8508,11 @@ private static String getSpeculatedStructAA2() {
 		return convertCommentsToSpeculative(getExpectedStructAA2());
 	}
 
+	private static String getExpectedSourceHierarchyAA2() {
+		String expected = "struct AA2 : AA2a, AA2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -8363,6 +8618,11 @@ private static String getSpeculatedStructAA3a() {
 		return convertCommentsToSpeculative(getExpectedStructAA3a());
 	}
 
+	private static String getExpectedSourceHierarchyAA3a() {
+		String expected = "struct AA3a : virtual AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3a]");
@@ -8484,6 +8744,11 @@ private static String getSpeculatedStructAA3b() {
 		return convertCommentsToSpeculative(getExpectedStructAA3b());
 	}
 
+	private static String getExpectedSourceHierarchyAA3b() {
+		String expected = "struct AA3b : virtual AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3b]");
@@ -8756,6 +9021,16 @@ private static String getSpeculatedStructAA3c() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyAA3c() {
+		String expected = "struct AA3c : virtual AA1, AA3a, AA3b";
+		return expected;
+	}
+
+	private static String getSpeculatedSourceHierarchyAA3c() {
+		String expected = "struct AA3c : AA3a, AA3b, virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA3a]	[AA3c, AA3a]");
@@ -8970,8 +9245,8 @@ private static String getSpeculatedStructAA3d() {
 			pack()
 			Structure AA3d {
 			   0   AA3d   16      "Self Base"
-			   16   AA2   12      "Virtual Base - Speculative Placement"
-			   28   AA1   12      "Virtual Base - Speculative Placement"
+			   16   AA1   12      "Virtual Base - Speculative Placement"
+			   28   AA2   12      "Virtual Base - Speculative Placement"
 			   40   AA3a   16      "Virtual Base - Speculative Placement"
 			   56   AA3b   16      "Virtual Base - Speculative Placement"
 			}
@@ -9041,6 +9316,11 @@ private static String getSpeculatedStructAA3d() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyAA3d() {
+		String expected = "struct AA3d : virtual AA1, virtual AA3a, virtual AA3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA3d]	[AA3d]");
@@ -9160,6 +9440,11 @@ private static String getSpeculatedStructAA3e() {
 		return convertCommentsToSpeculative(getExpectedStructAA3e());
 	}
 
+	private static String getExpectedSourceHierarchyAA3e() {
+		String expected = "struct AA3e : AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -9228,6 +9513,11 @@ private static String getSpeculatedStructAA3f() {
 		return convertCommentsToSpeculative(getExpectedStructAA3f());
 	}
 
+	private static String getExpectedSourceHierarchyAA3f() {
+		String expected = "struct AA3f : AA2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -9365,6 +9655,11 @@ private static String getSpeculatedStructAA3g() {
 		return convertCommentsToSpeculative(getExpectedStructAA3g());
 	}
 
+	private static String getExpectedSourceHierarchyAA3g() {
+		String expected = "struct AA3g : virtual AA3e, virtual AA3f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA3g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA3g]");
@@ -9487,6 +9782,11 @@ private static String getSpeculatedStructAA4a() {
 		return convertCommentsToSpeculative(getExpectedStructAA4a());
 	}
 
+	private static String getExpectedSourceHierarchyAA4a() {
+		String expected = "struct AA4a : virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4a]");
@@ -9608,6 +9908,11 @@ private static String getSpeculatedStructAA4b() {
 		return convertCommentsToSpeculative(getExpectedStructAA4b());
 	}
 
+	private static String getExpectedSourceHierarchyAA4b() {
+		String expected = "struct AA4b : virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4b]");
@@ -9774,6 +10079,11 @@ private static String getSpeculatedStructAA4c() {
 		return convertCommentsToSpeculative(getExpectedStructAA4c());
 	}
 
+	private static String getExpectedSourceHierarchyAA4c() {
+		String expected = "struct AA4c : AA4a, AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4a]	[AA4c, AA4a]");
@@ -9951,6 +10261,11 @@ private static String getSpeculatedStructAA4d() {
 		return convertCommentsToSpeculative(getExpectedStructAA4d());
 	}
 
+	private static String getExpectedSourceHierarchyAA4d() {
+		String expected = "struct AA4d : AA4b, virtual AA4a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4b]	[AA4d, AA4b]");
@@ -10129,6 +10444,11 @@ private static String getSpeculatedStructAA4e() {
 		return convertCommentsToSpeculative(getExpectedStructAA4e());
 	}
 
+	private static String getExpectedSourceHierarchyAA4e() {
+		String expected = "struct AA4e : AA4a, virtual AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4a]	[AA4e, AA4a]");
@@ -10308,6 +10628,11 @@ private static String getSpeculatedStructAA4f() {
 		return convertCommentsToSpeculative(getExpectedStructAA4f());
 	}
 
+	private static String getExpectedSourceHierarchyAA4f() {
+		String expected = "struct AA4f : virtual AA4a, virtual AA4b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA4f]	[AA4f]");
@@ -10482,6 +10807,11 @@ private static String getSpeculatedStructAA4g() {
 		return convertCommentsToSpeculative(getExpectedStructAA4g());
 	}
 
+	private static String getExpectedSourceHierarchyAA4g() {
+		String expected = "struct AA4g : AA4b, virtual AA1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4g, AA4b]");
@@ -10536,6 +10866,11 @@ private static String getSpeculatedStructAA4h() {
 		return convertCommentsToSpeculative(getExpectedStructAA4h());
 	}
 
+	private static String getExpectedSourceHierarchyAA4h() {
+		String expected = "struct AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4h() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -10621,6 +10956,11 @@ private static String getSpeculatedStructAA4j() {
 		return convertCommentsToSpeculative(getExpectedStructAA4j());
 	}
 
+	private static String getExpectedSourceHierarchyAA4j() {
+		String expected = "struct AA4j : virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4j]");
@@ -10722,6 +11062,11 @@ private static String getSpeculatedStructAA4k() {
 		return convertCommentsToSpeculative(getExpectedStructAA4k());
 	}
 
+	private static String getExpectedSourceHierarchyAA4k() {
+		String expected = "struct AA4k : virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4k() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4k]");
@@ -10842,6 +11187,11 @@ private static String getSpeculatedStructAA4m() {
 		return convertCommentsToSpeculative(getExpectedStructAA4m());
 	}
 
+	private static String getExpectedSourceHierarchyAA4m() {
+		String expected = "struct AA4m : AA4j";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4m() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4m, AA4j]");
@@ -10962,6 +11312,11 @@ private static String getSpeculatedStructAA4n() {
 		return convertCommentsToSpeculative(getExpectedStructAA4n());
 	}
 
+	private static String getExpectedSourceHierarchyAA4n() {
+		String expected = "struct AA4n : AA4k, virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4n() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4n, AA4k]");
@@ -11101,6 +11456,11 @@ private static String getSpeculatedStructAA4p() {
 		return convertCommentsToSpeculative(getExpectedStructAA4p());
 	}
 
+	private static String getExpectedSourceHierarchyAA4p() {
+		String expected = "struct AA4p : AA4m, virtual AA4h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4p() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA4p, AA4m, AA4j]");
@@ -11285,6 +11645,11 @@ private static String getSpeculatedStructAA4q() {
 		return convertCommentsToSpeculative(getExpectedStructAA4q());
 	}
 
+	private static String getExpectedSourceHierarchyAA4q() {
+		String expected = "struct AA4q : AA4n, AA4m";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA4q() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -11363,6 +11728,11 @@ private static String getSpeculatedStructAA5a() {
 		return convertCommentsToSpeculative(getExpectedStructAA5a());
 	}
 
+	private static String getExpectedSourceHierarchyAA5a() {
+		String expected = "struct AA5a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11401,6 +11771,11 @@ private static String getSpeculatedStructAA5b() {
 		return convertCommentsToSpeculative(getExpectedStructAA5b());
 	}
 
+	private static String getExpectedSourceHierarchyAA5b() {
+		String expected = "struct AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11439,6 +11814,11 @@ private static String getSpeculatedStructAA5c() {
 		return convertCommentsToSpeculative(getExpectedStructAA5c());
 	}
 
+	private static String getExpectedSourceHierarchyAA5c() {
+		String expected = "struct AA5c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11477,6 +11857,11 @@ private static String getSpeculatedStructAA5d() {
 		return convertCommentsToSpeculative(getExpectedStructAA5d());
 	}
 
+	private static String getExpectedSourceHierarchyAA5d() {
+		String expected = "struct AA5d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -11579,6 +11964,11 @@ private static String getSpeculatedStructAA5e() {
 		return convertCommentsToSpeculative(getExpectedStructAA5e());
 	}
 
+	private static String getExpectedSourceHierarchyAA5e() {
+		String expected = "struct AA5e : AA5a, virtual AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[AA5e]");
@@ -11697,6 +12087,11 @@ private static String getSpeculatedStructAA5f() {
 		return convertCommentsToSpeculative(getExpectedStructAA5f());
 	}
 
+	private static String getExpectedSourceHierarchyAA5f() {
+		String expected = "struct AA5f : AA5c, virtual AA5d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[AA5f]");
@@ -11846,6 +12241,11 @@ private static String getSpeculatedStructAA5g() {
 		return convertCommentsToSpeculative(getExpectedStructAA5g());
 	}
 
+	private static String getExpectedSourceHierarchyAA5g() {
+		String expected = "struct AA5g : AA5c, virtual AA5e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [AA5g]	[AA5g]");
@@ -12016,6 +12416,11 @@ private static String getSpeculatedStructAA5h() {
 		return convertCommentsToSpeculative(getExpectedStructAA5h());
 	}
 
+	private static String getExpectedSourceHierarchyAA5h() {
+		String expected = "struct AA5h : AA5a, virtual AA5f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [AA5h]	[AA5h]");
@@ -12280,6 +12685,11 @@ private static String getSpeculatedStructAA5j() {
 		return convertCommentsToSpeculative(getExpectedStructAA5j());
 	}
 
+	private static String getExpectedSourceHierarchyAA5j() {
+		String expected = "struct AA5j : AA5g, AA5h, virtual AA5b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA5j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [AA5g]	[AA5j, AA5g]");
@@ -12394,6 +12804,11 @@ private static String getSpeculatedStructAA6a() {
 		return convertCommentsToSpeculative(getExpectedStructAA6a());
 	}
 
+	private static String getExpectedSourceHierarchyAA6a() {
+		String expected = "struct AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12442,6 +12857,11 @@ private static String getSpeculatedStructAA6b() {
 		return convertCommentsToSpeculative(getExpectedStructAA6b());
 	}
 
+	private static String getExpectedSourceHierarchyAA6b() {
+		String expected = "struct AA6b : AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12527,6 +12947,11 @@ private static String getSpeculatedStructAA6c() {
 		return convertCommentsToSpeculative(getExpectedStructAA6c());
 	}
 
+	private static String getExpectedSourceHierarchyAA6c() {
+		String expected = "struct AA6c : virtual AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA6c]");
@@ -12589,6 +13014,11 @@ private static String getSpeculatedStructAA6d() {
 		return convertCommentsToSpeculative(getExpectedStructAA6d());
 	}
 
+	private static String getExpectedSourceHierarchyAA6d() {
+		String expected = "struct AA6d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12639,6 +13069,11 @@ private static String getSpeculatedStructAA6e() {
 		return convertCommentsToSpeculative(getExpectedStructAA6e());
 	}
 
+	private static String getExpectedSourceHierarchyAA6e() {
+		String expected = "struct AA6e : AA6a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12699,6 +13134,11 @@ private static String getSpeculatedStructAA6f() {
 		return convertCommentsToSpeculative(getExpectedStructAA6f());
 	}
 
+	private static String getExpectedSourceHierarchyAA6f() {
+		String expected = "struct AA6f : AA6b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -12811,6 +13251,11 @@ private static String getSpeculatedStructAA6g() {
 		return convertCommentsToSpeculative(getExpectedStructAA6g());
 	}
 
+	private static String getExpectedSourceHierarchyAA6g() {
+		String expected = "struct AA6g : AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[AA6g, AA6c]");
@@ -12941,6 +13386,11 @@ private static String getSpeculatedStructAA6h() {
 		return convertCommentsToSpeculative(getExpectedStructAA6h());
 	}
 
+	private static String getExpectedSourceHierarchyAA6h() {
+		String expected = "struct AA6h : virtual AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA6h]	[AA6h]");
@@ -13095,6 +13545,11 @@ private static String getSpeculatedStructAA6j() {
 		return convertCommentsToSpeculative(getExpectedStructAA6j());
 	}
 
+	private static String getExpectedSourceHierarchyAA6j() {
+		String expected = "struct AA6j : virtual AA6c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA6j() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [AA6j]	[AA6j]");
@@ -13182,6 +13637,11 @@ private static String getSpeculatedStructAA7a() {
 		return convertCommentsToSpeculative(getExpectedStructAA7a());
 	}
 
+	private static String getExpectedSourceHierarchyAA7a() {
+		String expected = "struct AA7a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[AA7a]");
@@ -13249,6 +13709,11 @@ private static String getSpeculatedStructAA7b() {
 		return convertCommentsToSpeculative(getExpectedStructAA7b());
 	}
 
+	private static String getExpectedSourceHierarchyAA7b() {
+		String expected = "struct AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[AA7b]");
@@ -13345,6 +13810,11 @@ private static String getSpeculatedStructAA7c() {
 		return convertCommentsToSpeculative(getExpectedStructAA7c());
 	}
 
+	private static String getExpectedSourceHierarchyAA7c() {
+		String expected = "struct AA7c : AA7a, AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [AA7a]	[AA7c, AA7a]");
@@ -13503,6 +13973,11 @@ private static String getSpeculatedStructAA7d() {
 		return convertCommentsToSpeculative(getExpectedStructAA7d());
 	}
 
+	private static String getExpectedSourceHierarchyAA7d() {
+		String expected = "struct AA7d : virtual AA7a, virtual AA7b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryAA7d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [AA7d]	[AA7d]");
@@ -13608,6 +14083,11 @@ private static String getSpeculatedStructBB1a() {
 		return convertCommentsToSpeculative(getExpectedStructBB1a());
 	}
 
+	private static String getExpectedSourceHierarchyBB1a() {
+		String expected = "struct BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -13656,6 +14136,11 @@ private static String getSpeculatedStructBB1b() {
 		return convertCommentsToSpeculative(getExpectedStructBB1b());
 	}
 
+	private static String getExpectedSourceHierarchyBB1b() {
+		String expected = "struct BB1b : BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -13741,6 +14226,11 @@ private static String getSpeculatedStructBB1c() {
 		return convertCommentsToSpeculative(getExpectedStructBB1c());
 	}
 
+	private static String getExpectedSourceHierarchyBB1c() {
+		String expected = "struct BB1c : virtual BB1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB1c]");
@@ -13889,6 +14379,11 @@ private static String getSpeculatedStructBB1d() {
 		return convertCommentsToSpeculative(getExpectedStructBB1d());
 	}
 
+	private static String getExpectedSourceHierarchyBB1d() {
+		String expected = "struct BB1d : BB1b, BB1c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB1d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[BB1d, BB1c]");
@@ -13943,6 +14438,11 @@ private static String getSpeculatedStructBB2z() {
 		return convertCommentsToSpeculative(getExpectedStructBB2z());
 	}
 
+	private static String getExpectedSourceHierarchyBB2z() {
+		String expected = "struct BB2z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2z() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14028,6 +14528,11 @@ private static String getSpeculatedStructBB2a() {
 		return convertCommentsToSpeculative(getExpectedStructBB2a());
 	}
 
+	private static String getExpectedSourceHierarchyBB2a() {
+		String expected = "struct BB2a : virtual BB2z";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2a() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2a]");
@@ -14148,6 +14653,11 @@ private static String getSpeculatedStructBB2b() {
 		return convertCommentsToSpeculative(getExpectedStructBB2b());
 	}
 
+	private static String getExpectedSourceHierarchyBB2b() {
+		String expected = "struct BB2b : BB2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2b, BB2a]");
@@ -14270,6 +14780,11 @@ private static String getSpeculatedStructBB2c() {
 		return convertCommentsToSpeculative(getExpectedStructBB2c());
 	}
 
+	private static String getExpectedSourceHierarchyBB2c() {
+		String expected = "struct BB2c : virtual BB2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt [BB2c]	[BB2c]");
@@ -14471,6 +14986,11 @@ private static String getSpeculatedStructBB2d() {
 		return convertCommentsToSpeculative(getExpectedStructBB2d());
 	}
 
+	private static String getExpectedSourceHierarchyBB2d() {
+		String expected = "struct BB2d : BB2b, BB2c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2d() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -14652,6 +15172,11 @@ private static String getSpeculatedStructBB2e() {
 		return convertCommentsToSpeculative(getExpectedStructBB2e());
 	}
 
+	private static String getExpectedSourceHierarchyBB2e() {
+		String expected = "struct BB2e : BB2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB2e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[BB2e, BB2b, BB2a]");
@@ -14706,6 +15231,11 @@ private static String getSpeculatedStructBB3a() {
 		return convertCommentsToSpeculative(getExpectedStructBB3a());
 	}
 
+	private static String getExpectedSourceHierarchyBB3a() {
+		String expected = "struct BB3a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14744,6 +15274,11 @@ private static String getSpeculatedStructBB3b() {
 		return convertCommentsToSpeculative(getExpectedStructBB3b());
 	}
 
+	private static String getExpectedSourceHierarchyBB3b() {
+		String expected = "struct BB3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14782,6 +15317,11 @@ private static String getSpeculatedStructBB3c() {
 		return convertCommentsToSpeculative(getExpectedStructBB3c());
 	}
 
+	private static String getExpectedSourceHierarchyBB3c() {
+		String expected = "struct BB3c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -14901,6 +15441,11 @@ private static String getSpeculatedStructBB3d() {
 		return convertCommentsToSpeculative(getExpectedStructBB3d());
 	}
 
+	private static String getExpectedSourceHierarchyBB3d() {
+		String expected = "struct BB3d : BB3a, BB3c, virtual BB3b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[BB3d]");
@@ -15031,6 +15576,11 @@ private static String getSpeculatedStructBB3e() {
 		return convertCommentsToSpeculative(getExpectedStructBB3e());
 	}
 
+	private static String getExpectedSourceHierarchyBB3e() {
+		String expected = "struct BB3e : BB3b, virtual BB3a, virtual BB3c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3e() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt []	[BB3e]");
@@ -15235,6 +15785,11 @@ private static String getSpeculatedStructBB3f() {
 		return convertCommentsToSpeculative(getExpectedStructBB3f());
 	}
 
+	private static String getExpectedSourceHierarchyBB3f() {
+		String expected = "struct BB3f : BB3d, BB3e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3f() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [BB3d]	[BB3f, BB3d]");
@@ -15456,6 +16011,11 @@ private static String getSpeculatedStructBB3g() {
 		return convertCommentsToSpeculative(getExpectedStructBB3g());
 	}
 
+	private static String getExpectedSourceHierarchyBB3g() {
+		String expected = "struct BB3g : BB3e, BB3d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryBB3g() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000008", "     8 vbt [BB3e]	[BB3g, BB3e]");
@@ -15528,6 +16088,11 @@ private static String getSpeculatedStructCC1a() {
 		return convertCommentsToSpeculative(getExpectedStructCC1a());
 	}
 
+	private static String getExpectedSourceHierarchyCC1a() {
+		String expected = "struct CC1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15566,6 +16131,11 @@ private static String getSpeculatedStructCC1b() {
 		return convertCommentsToSpeculative(getExpectedStructCC1b());
 	}
 
+	private static String getExpectedSourceHierarchyCC1b() {
+		String expected = "struct CC1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15604,6 +16174,11 @@ private static String getSpeculatedStructCC1c() {
 		return convertCommentsToSpeculative(getExpectedStructCC1c());
 	}
 
+	private static String getExpectedSourceHierarchyCC1c() {
+		String expected = "struct CC1c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15642,6 +16217,11 @@ private static String getSpeculatedStructCC1d() {
 		return convertCommentsToSpeculative(getExpectedStructCC1d());
 	}
 
+	private static String getExpectedSourceHierarchyCC1d() {
+		String expected = "struct CC1d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15680,6 +16260,11 @@ private static String getSpeculatedStructCC1e() {
 		return convertCommentsToSpeculative(getExpectedStructCC1e());
 	}
 
+	private static String getExpectedSourceHierarchyCC1e() {
+		String expected = "struct CC1e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15718,6 +16303,11 @@ private static String getSpeculatedStructCC1f() {
 		return convertCommentsToSpeculative(getExpectedStructCC1f());
 	}
 
+	private static String getExpectedSourceHierarchyCC1f() {
+		String expected = "struct CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -15817,6 +16407,11 @@ private static String getSpeculatedStructCC1g() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g() {
+		String expected = "struct CC1g : CC1a, CC1b, CC1c, CC1d, CC1e, CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16022,6 +16617,12 @@ private static String getSpeculatedStructCC1h() {
 		return expected;
 	}
 
+	private static String getExpectedSourceHierarchyCC1h() {
+		String expected =
+			"struct CC1h : virtual CC1a, virtual CC1b, virtual CC1c, virtual CC1d, virtual CC1e, virtual CC1f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[CC1h]");
@@ -16095,6 +16696,11 @@ private static String getSpeculatedStructCC1g_counterpoint() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g_counterpoint());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g_counterpoint() {
+		String expected = "struct CC1g_counterpoint";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g_counterpoint() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16148,6 +16754,11 @@ private static String getSpeculatedStructCC1h_counterpoint() {
 		return convertCommentsToSpeculative(getExpectedStructCC1h_counterpoint());
 	}
 
+	private static String getExpectedSourceHierarchyCC1h_counterpoint() {
+		String expected = "struct CC1h_counterpoint";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h_counterpoint() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16200,6 +16811,11 @@ private static String getSpeculatedStructCC1g_counterpoint2() {
 		return convertCommentsToSpeculative(getExpectedStructCC1g_counterpoint2());
 	}
 
+	private static String getExpectedSourceHierarchyCC1g_counterpoint2() {
+		String expected = "struct CC1g_counterpoint2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1g_counterpoint2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16253,6 +16869,11 @@ private static String getSpeculatedStructCC1h_counterpoint2() {
 		return convertCommentsToSpeculative(getExpectedStructCC1h_counterpoint2());
 	}
 
+	private static String getExpectedSourceHierarchyCC1h_counterpoint2() {
+		String expected = "struct CC1h_counterpoint2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC1h_counterpoint2() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16293,6 +16914,11 @@ private static String getSpeculatedStructCC2a() {
 		return convertCommentsToSpeculative(getExpectedStructCC2a());
 	}
 
+	private static String getExpectedSourceHierarchyCC2a() {
+		String expected = "struct CC2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16334,6 +16960,11 @@ private static String getSpeculatedStructCC2b() {
 		return convertCommentsToSpeculative(getExpectedStructCC2b());
 	}
 
+	private static String getExpectedSourceHierarchyCC2b() {
+		String expected = "struct CC2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16375,6 +17006,11 @@ private static String getSpeculatedStructCC2c() {
 		return convertCommentsToSpeculative(getExpectedStructCC2c());
 	}
 
+	private static String getExpectedSourceHierarchyCC2c() {
+		String expected = "struct CC2c";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16416,6 +17052,11 @@ private static String getSpeculatedStructCC2d() {
 		return convertCommentsToSpeculative(getExpectedStructCC2d());
 	}
 
+	private static String getExpectedSourceHierarchyCC2d() {
+		String expected = "struct CC2d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16457,6 +17098,11 @@ private static String getSpeculatedStructCC2e() {
 		return convertCommentsToSpeculative(getExpectedStructCC2e());
 	}
 
+	private static String getExpectedSourceHierarchyCC2e() {
+		String expected = "struct CC2e";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16498,6 +17144,11 @@ private static String getSpeculatedStructCC2f() {
 		return convertCommentsToSpeculative(getExpectedStructCC2f());
 	}
 
+	private static String getExpectedSourceHierarchyCC2f() {
+		String expected = "struct CC2f";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2f() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16539,6 +17190,11 @@ private static String getSpeculatedStructCC2g() {
 		return convertCommentsToSpeculative(getExpectedStructCC2g());
 	}
 
+	private static String getExpectedSourceHierarchyCC2g() {
+		String expected = "struct CC2g";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2g() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16580,6 +17236,11 @@ private static String getSpeculatedStructCC2h() {
 		return convertCommentsToSpeculative(getExpectedStructCC2h());
 	}
 
+	private static String getExpectedSourceHierarchyCC2h() {
+		String expected = "struct CC2h";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2h() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16621,6 +17282,11 @@ private static String getSpeculatedStructCC2j() {
 		return convertCommentsToSpeculative(getExpectedStructCC2j());
 	}
 
+	private static String getExpectedSourceHierarchyCC2j() {
+		String expected = "struct CC2j";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryCC2j() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16659,6 +17325,11 @@ private static String getSpeculatedStructDD1a() {
 		return convertCommentsToSpeculative(getExpectedStructDD1a());
 	}
 
+	private static String getExpectedSourceHierarchyDD1a() {
+		String expected = "struct DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -16744,6 +17415,11 @@ private static String getSpeculatedStructDD1b() {
 		return convertCommentsToSpeculative(getExpectedStructDD1b());
 	}
 
+	private static String getExpectedSourceHierarchyDD1b() {
+		String expected = "struct DD1b : virtual DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1b() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1b]");
@@ -16864,6 +17540,11 @@ private static String getSpeculatedStructDD1c() {
 		return convertCommentsToSpeculative(getExpectedStructDD1c());
 	}
 
+	private static String getExpectedSourceHierarchyDD1c() {
+		String expected = "struct DD1c : DD1b, virtual DD1a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1c() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1c, DD1b]");
@@ -16984,6 +17665,11 @@ private static String getSpeculatedStructDD1d() {
 		return convertCommentsToSpeculative(getExpectedStructDD1d());
 	}
 
+	private static String getExpectedSourceHierarchyDD1d() {
+		String expected = "struct DD1d : DD1b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD1d() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vbt []	[DD1d, DD1b]");
@@ -17038,6 +17724,11 @@ private static String getSpeculatedStructDD2a() {
 		return convertCommentsToSpeculative(getExpectedStructDD2a());
 	}
 
+	private static String getExpectedSourceHierarchyDD2a() {
+		String expected = "struct DD2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2a() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17076,6 +17767,11 @@ private static String getSpeculatedStructDD2b() {
 		return convertCommentsToSpeculative(getExpectedStructDD2b());
 	}
 
+	private static String getExpectedSourceHierarchyDD2b() {
+		String expected = "struct DD2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2b() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17124,6 +17820,11 @@ private static String getSpeculatedStructDD2c() {
 		return convertCommentsToSpeculative(getExpectedStructDD2c());
 	}
 
+	private static String getExpectedSourceHierarchyDD2c() {
+		String expected = "struct DD2c : DD2a";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2c() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17182,6 +17883,11 @@ private static String getSpeculatedStructDD2d() {
 		return convertCommentsToSpeculative(getExpectedStructDD2d());
 	}
 
+	private static String getExpectedSourceHierarchyDD2d() {
+		String expected = "struct DD2d : DD2a, DD2b";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2d() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17264,6 +17970,11 @@ private static String getSpeculatedStructDD2e() {
 		return convertCommentsToSpeculative(getExpectedStructDD2e());
 	}
 
+	private static String getExpectedSourceHierarchyDD2e() {
+		String expected = "struct DD2e : DD2c, DD2d";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryDD2e() {
 		Map<String, String> results = new TreeMap<>();
 		return results;
@@ -17657,6 +18368,162 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedStructs.put(DD2e, getSpeculatedStructDD2e());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(A, getExpectedSourceHierarchyA());
+		expectedSourceHierarchy.put(B, getExpectedSourceHierarchyB());
+		expectedSourceHierarchy.put(C, getExpectedSourceHierarchyC());
+		expectedSourceHierarchy.put(CC1, getExpectedSourceHierarchyCC1());
+		expectedSourceHierarchy.put(CC2, getExpectedSourceHierarchyCC2());
+		expectedSourceHierarchy.put(CC3, getExpectedSourceHierarchyCC3());
+		expectedSourceHierarchy.put(D, getExpectedSourceHierarchyD());
+		expectedSourceHierarchy.put(E, getExpectedSourceHierarchyE());
+		expectedSourceHierarchy.put(F, getExpectedSourceHierarchyF());
+		expectedSourceHierarchy.put(G, getExpectedSourceHierarchyG());
+		expectedSourceHierarchy.put(H, getExpectedSourceHierarchyH());
+		expectedSourceHierarchy.put(GG1, getExpectedSourceHierarchyGG1());
+		expectedSourceHierarchy.put(GG2, getExpectedSourceHierarchyGG2());
+		expectedSourceHierarchy.put(GG3, getExpectedSourceHierarchyGG3());
+		expectedSourceHierarchy.put(GG4, getExpectedSourceHierarchyGG4());
+		expectedSourceHierarchy.put(I, getExpectedSourceHierarchyI());
+		expectedSourceHierarchy.put(GX1, getExpectedSourceHierarchyGX1());
+		expectedSourceHierarchy.put(HX1, getExpectedSourceHierarchyHX1());
+		expectedSourceHierarchy.put(IX1, getExpectedSourceHierarchyIX1());
+		expectedSourceHierarchy.put(G1, getExpectedSourceHierarchyG1());
+		expectedSourceHierarchy.put(H1, getExpectedSourceHierarchyH1());
+		expectedSourceHierarchy.put(I1, getExpectedSourceHierarchyI1());
+		expectedSourceHierarchy.put(I2, getExpectedSourceHierarchyI2());
+		expectedSourceHierarchy.put(I3, getExpectedSourceHierarchyI3());
+		expectedSourceHierarchy.put(I4, getExpectedSourceHierarchyI4());
+		expectedSourceHierarchy.put(I5, getExpectedSourceHierarchyI5());
+		expectedSourceHierarchy.put(J1, getExpectedSourceHierarchyJ1());
+		expectedSourceHierarchy.put(J2, getExpectedSourceHierarchyJ2());
+		expectedSourceHierarchy.put(J3, getExpectedSourceHierarchyJ3());
+		expectedSourceHierarchy.put(J4, getExpectedSourceHierarchyJ4());
+		expectedSourceHierarchy.put(J5, getExpectedSourceHierarchyJ5());
+		expectedSourceHierarchy.put(J6, getExpectedSourceHierarchyJ6());
+		expectedSourceHierarchy.put(P, getExpectedSourceHierarchyP());
+		expectedSourceHierarchy.put(Q, getExpectedSourceHierarchyQ());
+		expectedSourceHierarchy.put(R, getExpectedSourceHierarchyR());
+		expectedSourceHierarchy.put(S, getExpectedSourceHierarchyS());
+		expectedSourceHierarchy.put(T, getExpectedSourceHierarchyT());
+		expectedSourceHierarchy.put(U, getExpectedSourceHierarchyU());
+		expectedSourceHierarchy.put(V, getExpectedSourceHierarchyV());
+		expectedSourceHierarchy.put(W, getExpectedSourceHierarchyW());
+		expectedSourceHierarchy.put(WW, getExpectedSourceHierarchyWW());
+		expectedSourceHierarchy.put(X, getExpectedSourceHierarchyX());
+		expectedSourceHierarchy.put(Z, getExpectedSourceHierarchyZ());
+		expectedSourceHierarchy.put(AA1a, getExpectedSourceHierarchyAA1a());
+		expectedSourceHierarchy.put(AA1b, getExpectedSourceHierarchyAA1b());
+		expectedSourceHierarchy.put(AA1, getExpectedSourceHierarchyAA1());
+		expectedSourceHierarchy.put(AA2a, getExpectedSourceHierarchyAA2a());
+		expectedSourceHierarchy.put(AA2b, getExpectedSourceHierarchyAA2b());
+		expectedSourceHierarchy.put(AA2, getExpectedSourceHierarchyAA2());
+		expectedSourceHierarchy.put(AA3a, getExpectedSourceHierarchyAA3a());
+		expectedSourceHierarchy.put(AA3b, getExpectedSourceHierarchyAA3b());
+		expectedSourceHierarchy.put(AA3c, getExpectedSourceHierarchyAA3c());
+		expectedSourceHierarchy.put(AA3d, getExpectedSourceHierarchyAA3d());
+		expectedSourceHierarchy.put(AA3e, getExpectedSourceHierarchyAA3e());
+		expectedSourceHierarchy.put(AA3f, getExpectedSourceHierarchyAA3f());
+		expectedSourceHierarchy.put(AA3g, getExpectedSourceHierarchyAA3g());
+		expectedSourceHierarchy.put(AA4a, getExpectedSourceHierarchyAA4a());
+		expectedSourceHierarchy.put(AA4b, getExpectedSourceHierarchyAA4b());
+		expectedSourceHierarchy.put(AA4c, getExpectedSourceHierarchyAA4c());
+		expectedSourceHierarchy.put(AA4d, getExpectedSourceHierarchyAA4d());
+		expectedSourceHierarchy.put(AA4e, getExpectedSourceHierarchyAA4e());
+		expectedSourceHierarchy.put(AA4f, getExpectedSourceHierarchyAA4f());
+		expectedSourceHierarchy.put(AA4g, getExpectedSourceHierarchyAA4g());
+		expectedSourceHierarchy.put(AA4h, getExpectedSourceHierarchyAA4h());
+		expectedSourceHierarchy.put(AA4j, getExpectedSourceHierarchyAA4j());
+		expectedSourceHierarchy.put(AA4k, getExpectedSourceHierarchyAA4k());
+		expectedSourceHierarchy.put(AA4m, getExpectedSourceHierarchyAA4m());
+		expectedSourceHierarchy.put(AA4n, getExpectedSourceHierarchyAA4n());
+		expectedSourceHierarchy.put(AA4p, getExpectedSourceHierarchyAA4p());
+		expectedSourceHierarchy.put(AA4q, getExpectedSourceHierarchyAA4q());
+		expectedSourceHierarchy.put(AA5a, getExpectedSourceHierarchyAA5a());
+		expectedSourceHierarchy.put(AA5b, getExpectedSourceHierarchyAA5b());
+		expectedSourceHierarchy.put(AA5c, getExpectedSourceHierarchyAA5c());
+		expectedSourceHierarchy.put(AA5d, getExpectedSourceHierarchyAA5d());
+		expectedSourceHierarchy.put(AA5e, getExpectedSourceHierarchyAA5e());
+		expectedSourceHierarchy.put(AA5f, getExpectedSourceHierarchyAA5f());
+		expectedSourceHierarchy.put(AA5g, getExpectedSourceHierarchyAA5g());
+		expectedSourceHierarchy.put(AA5h, getExpectedSourceHierarchyAA5h());
+		expectedSourceHierarchy.put(AA5j, getExpectedSourceHierarchyAA5j());
+		expectedSourceHierarchy.put(AA6a, getExpectedSourceHierarchyAA6a());
+		expectedSourceHierarchy.put(AA6b, getExpectedSourceHierarchyAA6b());
+		expectedSourceHierarchy.put(AA6c, getExpectedSourceHierarchyAA6c());
+		expectedSourceHierarchy.put(AA6d, getExpectedSourceHierarchyAA6d());
+		expectedSourceHierarchy.put(AA6e, getExpectedSourceHierarchyAA6e());
+		expectedSourceHierarchy.put(AA6f, getExpectedSourceHierarchyAA6f());
+		expectedSourceHierarchy.put(AA6g, getExpectedSourceHierarchyAA6g());
+		expectedSourceHierarchy.put(AA6h, getExpectedSourceHierarchyAA6h());
+		expectedSourceHierarchy.put(AA6j, getExpectedSourceHierarchyAA6j());
+		expectedSourceHierarchy.put(AA7a, getExpectedSourceHierarchyAA7a());
+		expectedSourceHierarchy.put(AA7b, getExpectedSourceHierarchyAA7b());
+		expectedSourceHierarchy.put(AA7c, getExpectedSourceHierarchyAA7c());
+		expectedSourceHierarchy.put(AA7d, getExpectedSourceHierarchyAA7d());
+		expectedSourceHierarchy.put(BB1a, getExpectedSourceHierarchyBB1a());
+		expectedSourceHierarchy.put(BB1b, getExpectedSourceHierarchyBB1b());
+		expectedSourceHierarchy.put(BB1c, getExpectedSourceHierarchyBB1c());
+		expectedSourceHierarchy.put(BB1d, getExpectedSourceHierarchyBB1d());
+		expectedSourceHierarchy.put(BB2z, getExpectedSourceHierarchyBB2z());
+		expectedSourceHierarchy.put(BB2a, getExpectedSourceHierarchyBB2a());
+		expectedSourceHierarchy.put(BB2b, getExpectedSourceHierarchyBB2b());
+		expectedSourceHierarchy.put(BB2c, getExpectedSourceHierarchyBB2c());
+		expectedSourceHierarchy.put(BB2d, getExpectedSourceHierarchyBB2d());
+		expectedSourceHierarchy.put(BB2e, getExpectedSourceHierarchyBB2e());
+		expectedSourceHierarchy.put(BB3a, getExpectedSourceHierarchyBB3a());
+		expectedSourceHierarchy.put(BB3b, getExpectedSourceHierarchyBB3b());
+		expectedSourceHierarchy.put(BB3c, getExpectedSourceHierarchyBB3c());
+		expectedSourceHierarchy.put(BB3d, getExpectedSourceHierarchyBB3d());
+		expectedSourceHierarchy.put(BB3e, getExpectedSourceHierarchyBB3e());
+		expectedSourceHierarchy.put(BB3f, getExpectedSourceHierarchyBB3f());
+		expectedSourceHierarchy.put(BB3g, getExpectedSourceHierarchyBB3g());
+		expectedSourceHierarchy.put(CC1a, getExpectedSourceHierarchyCC1a());
+		expectedSourceHierarchy.put(CC1b, getExpectedSourceHierarchyCC1b());
+		expectedSourceHierarchy.put(CC1c, getExpectedSourceHierarchyCC1c());
+		expectedSourceHierarchy.put(CC1d, getExpectedSourceHierarchyCC1d());
+		expectedSourceHierarchy.put(CC1e, getExpectedSourceHierarchyCC1e());
+		expectedSourceHierarchy.put(CC1f, getExpectedSourceHierarchyCC1f());
+		expectedSourceHierarchy.put(CC1g, getExpectedSourceHierarchyCC1g());
+		expectedSourceHierarchy.put(CC1h, getExpectedSourceHierarchyCC1h());
+		expectedSourceHierarchy.put(CC1g_counterpoint,
+			getExpectedSourceHierarchyCC1g_counterpoint());
+		expectedSourceHierarchy.put(CC1h_counterpoint,
+			getExpectedSourceHierarchyCC1h_counterpoint());
+		expectedSourceHierarchy.put(CC1g_counterpoint2,
+			getExpectedSourceHierarchyCC1g_counterpoint2());
+		expectedSourceHierarchy.put(CC1h_counterpoint2,
+			getExpectedSourceHierarchyCC1h_counterpoint2());
+		expectedSourceHierarchy.put(CC2a, getExpectedSourceHierarchyCC2a());
+		expectedSourceHierarchy.put(CC2b, getExpectedSourceHierarchyCC2b());
+		expectedSourceHierarchy.put(CC2c, getExpectedSourceHierarchyCC2c());
+		expectedSourceHierarchy.put(CC2d, getExpectedSourceHierarchyCC2d());
+		expectedSourceHierarchy.put(CC2e, getExpectedSourceHierarchyCC2e());
+		expectedSourceHierarchy.put(CC2f, getExpectedSourceHierarchyCC2f());
+		expectedSourceHierarchy.put(CC2g, getExpectedSourceHierarchyCC2g());
+		expectedSourceHierarchy.put(CC2h, getExpectedSourceHierarchyCC2h());
+		expectedSourceHierarchy.put(CC2j, getExpectedSourceHierarchyCC2j());
+		expectedSourceHierarchy.put(DD1a, getExpectedSourceHierarchyDD1a());
+		expectedSourceHierarchy.put(DD1b, getExpectedSourceHierarchyDD1b());
+		expectedSourceHierarchy.put(DD1c, getExpectedSourceHierarchyDD1c());
+		expectedSourceHierarchy.put(DD1d, getExpectedSourceHierarchyDD1d());
+		expectedSourceHierarchy.put(DD2a, getExpectedSourceHierarchyDD2a());
+		expectedSourceHierarchy.put(DD2b, getExpectedSourceHierarchyDD2b());
+		expectedSourceHierarchy.put(DD2c, getExpectedSourceHierarchyDD2c());
+		expectedSourceHierarchy.put(DD2d, getExpectedSourceHierarchyDD2d());
+		expectedSourceHierarchy.put(DD2e, getExpectedSourceHierarchyDD2e());
+	}
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+		// The following will replace entries as needed
+		speculatedSourceHierarchy.put(I5, getSpeculatedSourceHierarchyI5());
+		speculatedSourceHierarchy.put(J5, getSpeculatedSourceHierarchyJ5());
+		speculatedSourceHierarchy.put(AA3c, getSpeculatedSourceHierarchyAA3c());
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new LinkedHashMap<>();
 	static {
@@ -17809,7 +18676,6 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedVxtPtrSummaries.putAll(expectedVxtPtrSummaries);
 		// The following will replace entries as needed
 		speculatedVxtPtrSummaries.put(J5, getSpeculatedVxtPtrSummaryJ5());
-		speculatedVxtPtrSummaries.put(J6, getSpeculatedVxtPtrSummaryJ6());
 		// Need to implement values for classes P through DD2e
 	}
 
@@ -17963,7 +18829,6 @@ private static Map<String, String> getExpectedVxtStructsDD2e() {
 		speculatedVxtStructs.putAll(expectedVxtStructs);
 		// The following will replace entries as needed
 		speculatedVxtStructs.put(J5, getSpeculatedVxtStructsJ5());
-		speculatedVxtStructs.put(J6, getSpeculatedVxtStructsJ6());
 		// Need to implement values for classes P through DD2e
 
 		speculatedVxtStructs.put(T, getSpeculatedVxtStructsT());
@@ -18136,6 +19001,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm32ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm32ProgramCreator.java
index 358073486fa..62b9fc398c1 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm32ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm32ProgramCreator.java
@@ -860,6 +860,11 @@ private static String getSpeculatedStructP1() {
 		return convertCommentsToSpeculative(getExpectedStructP1());
 	}
 
+	private static String getExpectedSourceHierarchyP1() {
+		String expected = "struct P1NS::P1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P1NS::P1]");
@@ -953,6 +958,11 @@ private static String getSpeculatedStructP2() {
 		return convertCommentsToSpeculative(getExpectedStructP2());
 	}
 
+	private static String getExpectedSourceHierarchyP2() {
+		String expected = "struct P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P2NS::P2]");
@@ -1084,6 +1094,11 @@ private static String getSpeculatedStructQ1() {
 		return convertCommentsToSpeculative(getExpectedStructQ1());
 	}
 
+	private static String getExpectedSourceHierarchyQ1() {
+		String expected = "struct Q1NS::Q1 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q1NS::Q1, P1NS::P1]");
@@ -1246,6 +1261,11 @@ private static String getSpeculatedStructQ2() {
 		return convertCommentsToSpeculative(getExpectedStructQ2());
 	}
 
+	private static String getExpectedSourceHierarchyQ2() {
+		String expected = "struct Q2NS::Q2 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q2NS::Q2, P1NS::P1]");
@@ -1416,6 +1436,11 @@ private static String getSpeculatedStructQ3() {
 		return convertCommentsToSpeculative(getExpectedStructQ3());
 	}
 
+	private static String getExpectedSourceHierarchyQ3() {
+		String expected = "struct Q3NS::Q3 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q3NS::Q3, P1NS::P1]");
@@ -1626,6 +1651,11 @@ private static String getSpeculatedStructQ4() {
 		return convertCommentsToSpeculative(getExpectedStructQ4());
 	}
 
+	private static String getExpectedSourceHierarchyQ4() {
+		String expected = "struct Q4NS::Q4 : P2NS::P2, virtual P1NS::P1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P2NS::P2]	[Q4NS::Q4, P2NS::P2]");
@@ -1852,6 +1882,11 @@ private static String getSpeculatedStructQ5() {
 		return convertCommentsToSpeculative(getExpectedStructQ5());
 	}
 
+	private static String getExpectedSourceHierarchyQ5() {
+		String expected = "struct Q5NS::Q5 : P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q5NS::Q5, P1NS::P1]");
@@ -2078,6 +2113,11 @@ private static String getSpeculatedStructQ6() {
 		return convertCommentsToSpeculative(getExpectedStructQ6());
 	}
 
+	private static String getExpectedSourceHierarchyQ6() {
+		String expected = "struct Q6NS::Q6 : P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ6() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q6NS::Q6, P1NS::P1]");
@@ -2304,6 +2344,11 @@ private static String getSpeculatedStructQ7() {
 		return convertCommentsToSpeculative(getExpectedStructQ7());
 	}
 
+	private static String getExpectedSourceHierarchyQ7() {
+		String expected = "struct Q7NS::Q7 : virtual P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ7() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [Q7NS::Q7]	[Q7NS::Q7]");
@@ -2621,6 +2666,11 @@ private static String getSpeculatedStructR1() {
 		return convertCommentsToSpeculative(getExpectedStructR1());
 	}
 
+	private static String getExpectedSourceHierarchyR1() {
+		String expected = "struct R1NS::R1 : virtual Q1NS::Q1, virtual Q2NS::Q2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryR1() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -2827,6 +2877,26 @@ private static String getVxtStructR1_00000028() {
 		speculatedStructs.put(R1, getSpeculatedStructR1());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(P1, getExpectedSourceHierarchyP1());
+		expectedSourceHierarchy.put(P2, getExpectedSourceHierarchyP2());
+		expectedSourceHierarchy.put(Q1, getExpectedSourceHierarchyQ1());
+		expectedSourceHierarchy.put(Q2, getExpectedSourceHierarchyQ2());
+		expectedSourceHierarchy.put(Q3, getExpectedSourceHierarchyQ3());
+		expectedSourceHierarchy.put(Q4, getExpectedSourceHierarchyQ4());
+		expectedSourceHierarchy.put(Q5, getExpectedSourceHierarchyQ5());
+		expectedSourceHierarchy.put(Q6, getExpectedSourceHierarchyQ6());
+		expectedSourceHierarchy.put(Q7, getExpectedSourceHierarchyQ7());
+		expectedSourceHierarchy.put(R1, getExpectedSourceHierarchyR1());
+	}
+
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new TreeMap<>();
 	static {
@@ -2924,6 +2994,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm64ProgramCreator.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm64ProgramCreator.java
index d506bac2001..26da7f42614 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm64ProgramCreator.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/Vftm64ProgramCreator.java
@@ -868,6 +868,11 @@ private static String getSpeculatedStructP1() {
 		return convertCommentsToSpeculative(getExpectedStructP1());
 	}
 
+	private static String getExpectedSourceHierarchyP1() {
+		String expected = "struct P1NS::P1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P1NS::P1]");
@@ -962,6 +967,11 @@ private static String getSpeculatedStructP2() {
 		return convertCommentsToSpeculative(getExpectedStructP2());
 	}
 
+	private static String getExpectedSourceHierarchyP2() {
+		String expected = "struct P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryP2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft []	[P2NS::P2]");
@@ -1096,6 +1106,11 @@ private static String getSpeculatedStructQ1() {
 		return convertCommentsToSpeculative(getExpectedStructQ1());
 	}
 
+	private static String getExpectedSourceHierarchyQ1() {
+		String expected = "struct Q1NS::Q1 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ1() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q1NS::Q1, P1NS::P1]");
@@ -1260,6 +1275,11 @@ private static String getSpeculatedStructQ2() {
 		return convertCommentsToSpeculative(getExpectedStructQ2());
 	}
 
+	private static String getExpectedSourceHierarchyQ2() {
+		String expected = "struct Q2NS::Q2 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ2() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q2NS::Q2, P1NS::P1]");
@@ -1433,6 +1453,11 @@ private static String getSpeculatedStructQ3() {
 		return convertCommentsToSpeculative(getExpectedStructQ3());
 	}
 
+	private static String getExpectedSourceHierarchyQ3() {
+		String expected = "struct Q3NS::Q3 : P1NS::P1, P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ3() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q3NS::Q3, P1NS::P1]");
@@ -1646,6 +1671,11 @@ private static String getSpeculatedStructQ4() {
 		return convertCommentsToSpeculative(getExpectedStructQ4());
 	}
 
+	private static String getExpectedSourceHierarchyQ4() {
+		String expected = "struct Q4NS::Q4 : P2NS::P2, virtual P1NS::P1";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ4() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P2NS::P2]	[Q4NS::Q4, P2NS::P2]");
@@ -1875,6 +1905,11 @@ private static String getSpeculatedStructQ5() {
 		return convertCommentsToSpeculative(getExpectedStructQ5());
 	}
 
+	private static String getExpectedSourceHierarchyQ5() {
+		String expected = "struct Q5NS::Q5 : P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ5() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q5NS::Q5, P1NS::P1]");
@@ -2104,6 +2139,11 @@ private static String getSpeculatedStructQ6() {
 		return convertCommentsToSpeculative(getExpectedStructQ6());
 	}
 
+	private static String getExpectedSourceHierarchyQ6() {
+		String expected = "struct Q6NS::Q6 : P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ6() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [P1NS::P1]	[Q6NS::Q6, P1NS::P1]");
@@ -2333,6 +2373,11 @@ private static String getSpeculatedStructQ7() {
 		return convertCommentsToSpeculative(getExpectedStructQ7());
 	}
 
+	private static String getExpectedSourceHierarchyQ7() {
+		String expected = "struct Q7NS::Q7 : virtual P1NS::P1, virtual P2NS::P2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryQ7() {
 		Map<String, String> results = new TreeMap<>();
 		results.put("VTABLE_00000000", "     0 vft [Q7NS::Q7]	[Q7NS::Q7]");
@@ -2657,6 +2702,11 @@ private static String getSpeculatedStructR1() {
 		return convertCommentsToSpeculative(getExpectedStructR1());
 	}
 
+	private static String getExpectedSourceHierarchyR1() {
+		String expected = "struct R1NS::R1 : virtual Q1NS::Q1, virtual Q2NS::Q2";
+		return expected;
+	}
+
 	private static Map<String, String> getExpectedVxtPtrSummaryR1() {
 		Map<String, String> results = new TreeMap<>();
 		// This is the real expected result, but passing null tells the test to skip doing the
@@ -2863,6 +2913,26 @@ private static String getVxtStructR1_00000050() {
 		speculatedStructs.put(R1, getSpeculatedStructR1());
 	}
 
+	private static final Map<ClassID, String> expectedSourceHierarchy = new LinkedHashMap<>();
+	static {
+		expectedSourceHierarchy.put(P1, getExpectedSourceHierarchyP1());
+		expectedSourceHierarchy.put(P2, getExpectedSourceHierarchyP2());
+		expectedSourceHierarchy.put(Q1, getExpectedSourceHierarchyQ1());
+		expectedSourceHierarchy.put(Q2, getExpectedSourceHierarchyQ2());
+		expectedSourceHierarchy.put(Q3, getExpectedSourceHierarchyQ3());
+		expectedSourceHierarchy.put(Q4, getExpectedSourceHierarchyQ4());
+		expectedSourceHierarchy.put(Q5, getExpectedSourceHierarchyQ5());
+		expectedSourceHierarchy.put(Q6, getExpectedSourceHierarchyQ6());
+		expectedSourceHierarchy.put(Q7, getExpectedSourceHierarchyQ7());
+		expectedSourceHierarchy.put(R1, getExpectedSourceHierarchyR1());
+	}
+
+	private static final Map<ClassID, String> speculatedSourceHierarchy =
+		new LinkedHashMap<>();
+	static {
+		speculatedSourceHierarchy.putAll(expectedSourceHierarchy);
+	}
+
 	private static final Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 		new TreeMap<>();
 	static {
@@ -2960,6 +3030,14 @@ public Map<ClassID, String> getSpeculatedStructs() {
 		return speculatedStructs;
 	}
 
+	public Map<ClassID, String> getExpectedSourceHierarchy() {
+		return expectedSourceHierarchy;
+	}
+
+	public Map<ClassID, String> getSpeculatedSourceHierarchy() {
+		return speculatedSourceHierarchy;
+	}
+
 	public Map<ClassID, Map<String, String>> getExpectedVxtPtrSummaries() {
 		return expectedVxtPtrSummaries;
 	}
diff --git a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeTypeTest.java b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeTypeTest.java
index c668d785caf..f9e79de189d 100644
--- a/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeTypeTest.java
+++ b/Ghidra/Features/PDB/src/test/java/ghidra/app/util/pdb/pdbapplicator/CppCompositeTypeTest.java
@@ -2074,13 +2074,14 @@ public void testEgray8_32() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = egray832VxtManager;
 		Map<ClassID, String> expectedResults = egray832Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = egray832Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			egray832Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			egray832Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2102,7 +2103,7 @@ public void testEgray8_32_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = egray832Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2120,13 +2121,15 @@ public void testEgray8_32_noProgram_speculative() throws Exception {
 		DataTypeManager dtm = dtm32;
 		MsVxtManager vxtManager = egray832VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = egray832Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy =
+			egray832Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			egray832Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			egray832Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2145,13 +2148,14 @@ public void testEgray8_64() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = egray864VxtManager;
 		Map<ClassID, String> expectedResults = egray864Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = egray864Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			egray864Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			egray864Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2173,7 +2177,7 @@ public void testEgray8_64_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = egray864Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2191,13 +2195,15 @@ public void testEgray8_64_noProgram_speculative() throws Exception {
 		DataTypeManager dtm = dtm64;
 		MsVxtManager vxtManager = egray864VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = egray864Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy =
+			egray832Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			egray864Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			egray864Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2216,13 +2222,14 @@ public void testVftm_32() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = vftm32VxtManager;
 		Map<ClassID, String> expectedResults = vftm32Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = vftm32Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			vftm32Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			vftm32Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2244,7 +2251,7 @@ public void testVftm_32_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = vftm32Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2262,13 +2269,14 @@ public void testVftm_32_noProgram_speculative() throws Exception {
 		DataTypeManager dtm = dtm32;
 		MsVxtManager vxtManager = vftm32VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = vftm32Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = vftm32Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			vftm32Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			vftm32Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2287,13 +2295,14 @@ public void testVftm_64() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = vftm64VxtManager;
 		Map<ClassID, String> expectedResults = vftm64Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = vftm64Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			vftm64Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			vftm64Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2315,7 +2324,7 @@ public void testVftm_64_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = vftm64Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2333,13 +2342,14 @@ public void testVftm_64_noProgram_speculative() throws Exception {
 		DataTypeManager dtm = dtm64;
 		MsVxtManager vxtManager = vftm64VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = vftm64Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = vftm32Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			vftm64Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			vftm64Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2358,13 +2368,14 @@ public void testCfb4_32() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = cfb432VxtManager;
 		Map<ClassID, String> expectedResults = cfb432Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = cfb432Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			cfb432Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			cfb432Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2386,7 +2397,7 @@ public void testCfb4_32_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = cfb432Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2404,13 +2415,14 @@ public void testCfb4_32_speculative() throws Exception {
 		DataTypeManager dtm = dtm32;
 		MsVxtManager vxtManager = cfb432VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = cfb432Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = cfb432Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			cfb432Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			cfb432Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2429,13 +2441,14 @@ public void testCfb4_64() throws Exception {
 		DataTypeManager dtm = program.getDataTypeManager();
 		MsVxtManager vxtManager = cfb464VxtManager;
 		Map<ClassID, String> expectedResults = cfb464Creator.getExpectedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = cfb464Creator.getExpectedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			cfb464Creator.getExpectedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			cfb464Creator.getExpectedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2457,7 +2470,7 @@ public void testCfb4_64_noProgram() throws Exception {
 		Map<ClassID, String> expectedResults = cfb464Creator.getFillerStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, classLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, null);
+				expectedResults, null, null);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		// Not checking vxt structures here.
@@ -2475,13 +2488,14 @@ public void testCfb4_64_noProgram_speculative() throws Exception {
 		DataTypeManager dtm = dtm64;
 		MsVxtManager vxtManager = cfb464VxtManagerNoProgram;
 		Map<ClassID, String> expectedResults = cfb464Creator.getSpeculatedStructs();
+		Map<ClassID, String> expectedSourceHierarchy = cfb432Creator.getSpeculatedSourceHierarchy();
 		Map<ClassID, Map<String, String>> expectedVxtPtrSummaries =
 			cfb464Creator.getSpeculatedVxtPtrSummaries();
 		Map<ClassID, Map<String, String>> expectedVxtStructs =
 			cfb464Creator.getSpeculatedVxtStructs();
 		dtm.withTransaction("Processing data.", () -> {
 			createAndTestStructures(program, dtm, speculativeLayoutChoice, pdb, is64Bit, vxtManager,
-				expectedResults, expectedVxtPtrSummaries);
+				expectedResults, expectedSourceHierarchy, expectedVxtPtrSummaries);
 			vxtManager.createTables(dtm, clearMode);
 		});
 		checkVxtStructures(dtm, expectedVxtStructs);
@@ -2492,6 +2506,7 @@ public void testCfb4_64_noProgram_speculative() throws Exception {
 	private void createAndTestStructures(Program program, DataTypeManager dtm,
 			ObjectOrientedClassLayout layoutChoice, MockPdb pdb, boolean is64Bit,
 			MsVxtManager vxtManager, Map<ClassID, String> expectedResults,
+			Map<ClassID, String> expectedSourceHierarchy,
 			Map<ClassID, Map<String, String>> expectedVxtPtrSummaries) throws Exception {
 
 		for (CppCompositeType cppType : pdb.getCppTypes()) {
@@ -2503,6 +2518,13 @@ private void createAndTestStructures(Program program, DataTypeManager dtm,
 				continue;
 			}
 			CompositeTestUtils.assertExpectedComposite(this, expected, composite, true);
+			String description = composite.getDescription();
+			if (expectedSourceHierarchy != null) {
+				String expectedSource = expectedSourceHierarchy.get(id);
+				// next line to aid in creating tests
+				//System.out.println(description);
+				assertEquals(expectedSource, description);
+			}
 			if (expectedVxtPtrSummaries == null) {
 				continue;
 			}
```
-----------------------------------
