# Commit: d5df2590dc6b56f1edf1b7642504909dbd867ae1
## Message: Fix: TaintAnalysis query use chosen file if none set in tool options
## Diff:
```
diff --git a/Ghidra/Debug/Debugger/src/main/java/ghidra/app/plugin/core/debug/taint/AngrTaintState.java b/Ghidra/Debug/Debugger/src/main/java/ghidra/app/plugin/core/debug/taint/AngrTaintState.java
index b22a1426ae2..33cba2b11b8 100644
--- a/Ghidra/Debug/Debugger/src/main/java/ghidra/app/plugin/core/debug/taint/AngrTaintState.java
+++ b/Ghidra/Debug/Debugger/src/main/java/ghidra/app/plugin/core/debug/taint/AngrTaintState.java
@@ -55,10 +55,10 @@ public AngrTaintState(TaintPlugin plugin) {
 	private Address start;
 
 	@Override
-	public void buildQuery(List<String> paramList, Path engine, File indexDBFile,
+	public void buildQuery(List<String> paramList, String engine_path, File indexDBFile,
 			String indexDirectory) {
 		paramList.add("python");
-		paramList.add(engine.toString());
+		paramList.add(engine_path);
 	}
 
 	@Override
diff --git a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/AbstractTaintState.java b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/AbstractTaintState.java
index 205540c03d5..8398b85c3cf 100644
--- a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/AbstractTaintState.java
+++ b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/AbstractTaintState.java
@@ -67,7 +67,7 @@ public AbstractTaintState(TaintPlugin plugin) {
 		this.plugin = plugin;
 	}
 
-	public abstract void buildQuery(List<String> param_list, Path engine, File indexDBFile,
+	public abstract void buildQuery(List<String> param_list, String engine_path, File indexDBFile,
 			String index_directory);
 
 	@Override
@@ -296,7 +296,7 @@ public boolean queryIndex(Program program, PluginTool tool, QueryType queryType)
 					plugin.consoleMessage("Unknown query type.");
 			}
 
-			buildQuery(paramList, engine, indexDBFile, indexDirectory.toString());
+			buildQuery(paramList, engineFile.toString(), indexDBFile, indexDirectory.toString());
 
 			if (queryType.equals(QueryType.SRCSINK) || queryType.equals(QueryType.CUSTOM)) {
 				// The datalog that specifies the query.
diff --git a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/CreateTargetIndexTask.java b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/CreateTargetIndexTask.java
index 5bd74624627..5560840fed9 100644
--- a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/CreateTargetIndexTask.java
+++ b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/CreateTargetIndexTask.java
@@ -125,7 +125,7 @@ public void run(TaskMonitor monitor) throws CancelledException {
 			engineFile = getFilePath(enginePathName, "Select the engine binary");
 		}
 
-		consoleService.addMessage("Create Index", "using engine at: " + enginePath.toString());
+		consoleService.addMessage("Create Index", "using engine at: " + engineFile.toString());
 
 		Path factsPath = Path.of(factsDirectory);
 
diff --git a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/ctadl/CTADLTaintState.java b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/ctadl/CTADLTaintState.java
index 89f78d8a517..e0d2b373b74 100644
--- a/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/ctadl/CTADLTaintState.java
+++ b/Ghidra/Features/DecompilerDependent/src/main/java/ghidra/app/plugin/core/decompiler/taint/ctadl/CTADLTaintState.java
@@ -42,9 +42,9 @@ public CTADLTaintState(TaintPlugin plugin) {
 	}
 
 	@Override
-	public void buildQuery(List<String> paramList, Path engine, File indexDBFile,
+	public void buildQuery(List<String> paramList, String engine_path, File indexDBFile,
 			String indexDirectory) {
-		paramList.add(engine.toString());
+		paramList.add(engine_path);
 		paramList.add("--directory");
 		paramList.add(indexDirectory);
 		paramList.add("query");
```
-----------------------------------
