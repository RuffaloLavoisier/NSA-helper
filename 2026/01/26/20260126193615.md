# Commit: af56f9650a655e2f92369de1cbd4398892929734
## Message: Merge remote-tracking branch 'origin/patch'
## Diff:
```
diff --git a/Ghidra/Features/Decompiler/ghidra_scripts/classrecovery/RecoveredClassHelper.java b/Ghidra/Features/Decompiler/ghidra_scripts/classrecovery/RecoveredClassHelper.java
index 6053f00f84e..b70ac04371b 100644
--- a/Ghidra/Features/Decompiler/ghidra_scripts/classrecovery/RecoveredClassHelper.java
+++ b/Ghidra/Features/Decompiler/ghidra_scripts/classrecovery/RecoveredClassHelper.java
@@ -474,6 +474,7 @@ public Map<Address, Function> getFunctionCallMap(Function function, boolean getT
 				//TODO: the above continue is preventing the nulls and exts here - do we want this?
 				// or do we want another map/option?
 				functionCallMap.put(instruction.getMinAddress(), calledFunction);
+				continue;
 			}
 			if (instruction.getFlowOverride().equals(FlowOverride.CALL_RETURN)) {
 				Reference reference = instruction.getPrimaryReference(0);
diff --git a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/database/data/UnionDB.java b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/database/data/UnionDB.java
index a9d9d2f7403..2bad3845792 100644
--- a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/database/data/UnionDB.java
+++ b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/database/data/UnionDB.java
@@ -336,6 +336,9 @@ public void replaceWith(DataType dataType) {
 	void doReplaceWith(UnionInternal union, boolean notify)
 			throws DataTypeDependencyException, IOException {
 
+		int oldAlignment = getAlignment();
+		int oldLength = unionLength;
+
 		// pre-resolved component types to catch dependency issues early
 		DataTypeComponent[] otherComponents = union.getComponents();
 		DataType[] resolvedDts = new DataType[otherComponents.length];
@@ -359,13 +362,21 @@ void doReplaceWith(UnionInternal union, boolean notify)
 			doAdd(resolvedDts[i], dtc.getLength(), dtc.getFieldName(), dtc.getComment(), false);
 		}
 
-		record.setString(CompositeDBAdapter.COMPOSITE_COMMENT_COL, union.getDescription());
-		compositeAdapter.updateRecord(record, false);
+		repack(false, false);
 
-		repack(false, false); // updates timestamp
+		record.setString(CompositeDBAdapter.COMPOSITE_COMMENT_COL, union.getDescription());
+		compositeAdapter.updateRecord(record, true); // updates timestamp
 
 		if (notify) {
-			notifySizeChanged(false); // assume size and/or alignment changed
+			if (unionLength != oldLength) {
+				notifySizeChanged(false);
+			}
+			else if (unionAlignment != oldAlignment) {
+				notifyAlignmentChanged(false);
+			}
+			else {
+				dataMgr.dataTypeChanged(this, false);
+			}
 		}
 
 		if (pointerPostResolveRequired) {
diff --git a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/StructureDataType.java b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/StructureDataType.java
index 5015d41eb5d..5ff037ffba1 100644
--- a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/StructureDataType.java
+++ b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/StructureDataType.java
@@ -1237,7 +1237,7 @@ public void replaceWith(DataType dataType) {
 		}
 
 		repack(false);
-		notifySizeChanged();
+		notifySizeChanged(); // simplified assumption to force parents to update
 	}
 
 	private void doReplaceWithPacked(Structure struct) {
diff --git a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/UnionDataType.java b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/UnionDataType.java
index 966ae24949e..d21431fc9b2 100644
--- a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/UnionDataType.java
+++ b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/program/model/data/UnionDataType.java
@@ -584,7 +584,7 @@ public void replaceWith(DataType dataType) throws IllegalArgumentException {
 		}
 
 		repack(false);
-		notifySizeChanged(); // assume size and/or alignment changed
+		notifySizeChanged(); // simplified assumption to force parents to update
 	}
 
 	@Override
```
-----------------------------------
